webpackJsonp([20],{"/CR/":function(t,a,n){t.exports=n.p+"static/img/nav-bg.15f7803.png"},TJfZ:function(t,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=n("JaHG"),e={name:"ClasicNavigation",data:function(){return{params:{name:"classic-navigation",wareType:"normal"},playBtns:["play12","play23","playall"],playIndex:-1,navTypes:[{name:"顺水航行",isSelected:!1,velocity:8,mode:1},{name:"静水航行",isSelected:!1,velocity:8,mode:0},{name:"逆水航行",isSelected:!1,velocity:8,mode:-1}],waterVelocity:2,navLowV:0,btnSrcs:{playall:"./static/images/math/navigation/play-all.png",play12:"./static/images/math/navigation/play12.png",play23:"./static/images/math/navigation/play23.png",playall0:"./static/images/math/navigation/play-all-selected.png",play120:"./static/images/math/navigation/play12-selected.png",play230:"./static/images/math/navigation/play23-selected.png",reset:"./static/images/math/chase/reset.png"},velocityTips:["V顺=V船+V水","V静=V船","V逆=V船-V水"],cWaters:[],cShips:[],cVelocityTips:[],cNavigations:[],cancelAnim:!1,unitV:8,unitL:100}},methods:{setParams:function(t){for(var a in t)t.hasOwnProperty(a)&&void 0!==this.params[a]&&(this.params[a]=t[a]);this.initNavigation()},setSectionMode:function(t){},onClickNavigation:function(t){var a=this;this.playIndex=t,this.cancelAnim=!0;for(var n=0;n<this.cShips.length;n++)this.navTypes[n].isSelected=!0,this.cShips[n].set("left",-470);this.cWaters[0].set("cropX",1275),this.cWaters[2].set("cropX",0),this.canvas.requestRenderAll(),0===t?this.navTypes[2].isSelected=!1:1===t&&(this.navTypes[0].isSelected=!1),window.requestAnimationFrame(function(){a.cancelAnim=!1,a.navLowV=100;for(var t=0,n=0;n<a.cShips.length;n++){var i=a.navTypes[n];if(i.isSelected){var e=i.velocity+i.mode*a.waterVelocity;a.navLowV>e&&(a.navLowV=e),t++}}0!==t&&a.animateWaterAndShip()})},animateWaterAndShip:function(){var t=this,a=this.getRealTime(this.navLowV,960);console.log("animateWaterAndShip() "+a),this.animeCount=0,fabric.util.animate({startValue:0,endValue:a,abort:function(){return t.cancelAnim},duration:a,onChange:function(a){for(var n=0;n<t.cShips.length;n++){var i=t.navTypes[n];if(i.isSelected){var e=i.velocity+i.mode*t.waterVelocity,s=t.getNavLength(e,a);s-470>400&&(s=870,i.isSelected=!1),t.cShips[n].set("left",s-470);var o=t.getNavLength(t.waterVelocity,a);1===i.mode?t.cWaters[n].set("cropX",1275-o):-1===i.mode&&t.cWaters[n].set("cropX",o)}}t.canvas.renderAll(),t.animeCount++},onComplete:function(){console.log("average count="+t.animeCount/a*1e3)},easing:function(t,a,n,i){return t/i*n+a}})},getRealTime:function(t,a){var n=this.unitV/t;return 1e3*(n*=a/this.unitL)},getNavLength:function(t,a){return t/this.unitV*(a/1e3)*this.unitL},initFabric:function(){var t=this.$refs.canvas;t.width=1280,t.height=800,this.canvas=new fabric.StaticCanvas(t)},initNavigation:function(){var t=this;this.canvas?this.createNavigationBase():setTimeout(function(){t.initNavigation()},100)},createNavigation:function(){var t=this;if(1===this.baseCount){var a=document.createElement("IMG");a.src="./static/images/math/navigation/ship.png",a.onload=function(n){for(var i=0;i<3;i++){var e=new fabric.Image(a,{top:-10,left:170});t.cShips.push(e);var s=new fabric.Group([t.cWaters[i],t.cShips[i]],{top:130+172*i,left:0});t.canvas.add(s),t.cNavigations.push(s);var o={0:{1:{fontSize:14,deltaY:7},4:{fontSize:14,deltaY:7}}};1!==i&&(o[0][7]={fontSize:14,deltaY:7});var c=new fabric.IText(t.velocityTips[i],{top:130+172*(i+1)-40,fontSize:36,fontFamily:"MicrosoftYaHei",fill:"#262626",styles:o});c.set("left",640-c.width/2),t.canvas.add(c),t.cVelocityTips.push(c)}a.onload=null}}},createNavigationBase:function(){var t=this;if(1!==this.baseCount){this.baseCount=0;var a=document.createElement("IMG");a.src="./static/images/math/navigation/water.png",a.onload=function(n){for(var i=0;i<3;i++){var e=new fabric.Image(a,{width:1280,height:n.target.height});0===i?e.set("cropX",1275):e.set("cropX",0),t.cWaters.push(e)}t.baseCount++,a.onload=null,t.createNavigation()}}}},created:function(){window.classicNavigation=this},mounted:function(){var t=this;Object(i.a)("static/fabric/fabric.min.js",function(){t.initFabric()})},destroyed:function(){this.cancelAnim=!0}},s={render:function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"classic-navigation"},[n("canvas",{ref:"canvas"}),t._v(" "),n("div",{staticClass:"classic-navigation-mode"},t._l(t.navTypes,function(a,i){return n("div",{key:i,staticClass:"classic-navigation-type"},[t._v(t._s(a.name))])})),t._v(" "),n("div",{staticClass:"navigation-btns"},t._l(t.playBtns,function(a,i){return n("img",{key:a,staticClass:"navigation-btn",attrs:{src:i===t.playIndex?t.btnSrcs[a+"0"]:t.btnSrcs[a]},on:{click:function(a){a.stopPropagation(),t.onClickNavigation(i)}}})}))])},staticRenderFns:[]};var o=n("VU/8")(e,s,!1,function(t){n("rSi0")},"data-v-dff4bec0",null);a.default=o.exports},rSi0:function(t,a,n){var i=n("rSqT");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);n("rjj0")("397f0c31",i,!0,{})},rSqT:function(t,a,n){var i=n("kxFB");(t.exports=n("FZ+f")(!1)).push([t.i,"\n.classic-navigation[data-v-dff4bec0] {\n  width: 1280px;\n  height: 800px;\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 10;\n  background-image: url("+i(n("/CR/"))+");\n  border-radius: inherit;\n}\n.classic-navigation-mode[data-v-dff4bec0] {\n  width: 160px;\n  position: absolute;\n  top: 153px;\n  left: 0px;\n}\n.classic-navigation-type[data-v-dff4bec0] {\n  width: 100%;\n  height: 86px;\n  background-color: white;\n  line-height: 86px;\n  padding-left: 12px;\n  font-size: 32px;\n  color: #262626;\n  margin-bottom: 80px;\n  border: 3px solid white;\n  border-top-right-radius: 50px;\n  border-bottom-right-radius: 50px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.navigation-btns[data-v-dff4bec0] {\n  display: inline-block;\n  width: auto;\n  position: absolute;\n  bottom: 60px;\n  left: 50%;\n  -webkit-transform: translate(-50%, 0%);\n          transform: translate(-50%, 0%);\n}\n.navigation-btn[data-v-dff4bec0] {\n  margin: 0 25px;\n}\n\n",""])}});