webpackJsonp([30],{"+BTi":function(e,t){},0:function(e,t){},GXEp:function(e,t){},H3rH:function(e,t){},JZJL:function(e,t,n){"use strict";n("R3KO");t.a=function(e,t,n,a){return function(r,s){var i=(1280-160*r)/(r+1),o=0;n.preViousWareObjs||(n.preViousWareObjs=n.wareObj.areas),n.wareObj.areas=n.preViousWareObjs.map(function(e){return"area-animals"===e.params.wareType?++o<=s?e:null:e}).filter(function(e){return e}),e.forEach(function(e,t){if(t<r){e.$refs.ddmrrDom.style.display="",e.params.transX=e.params.preTransX=i+t*(160+i),e.params.transY=e.params.preTransY,e.inCage&&(e.inCage=!1);var n=e.$refs.ddmrrDom.querySelector("canvas").getContext("2d");n.clearRect(0,0,a.width,a.height),n.drawImage(a,0,0,a.width,a.height)}else e.$refs.ddmrrDom.style.display="none"});var c=(1280-160*s)/(s+1);t.forEach(function(e,t){t<s?(e.$refs.ddmrrDom.style.display="",e.params.transX=e.params.preTransX=c+t*(160+c)):e.$refs.ddmrrDom.style.display="none"})}}},JaHG:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return r}),n.d(t,"b",function(){return s});var a=function(e,t){var n=document.getElementsByTagName("head")[0];if(n){var a=n.getElementsByTagName("script"),r=!1;if(a)for(var s=a.length,i=0;i<s;i++)a[i].src.endsWith(e)&&(r=!0);if(r)t&&t();else{var o=document.createElement("script");o.setAttribute("type","text/javascript"),o.setAttribute("src",e),o.onload=function(n){o.onload=null,console.log("loadJS '"+e+"' success"),t&&t()},document.getElementsByTagName("head")[0].appendChild(o)}}},r=function(e,t,n,a,r,s){if(e<=0)return[];n||(n=0),a||(a=0),r||(r=1280),s||(s=800),t<10&&(t=10);var i=[],o=[],c=Math.ceil((r-2*n)/t),u=Math.ceil((s-a)/t),l=c*u;l<e&&(e=l,console.log("randomPositions() over calculate the positions count"));for(var h=Math.ceil(Math.sqrt(e/(12/7))),p=(c-Math.round(12*h/7))/2,d=u-h,m=p;m<c-p;m++)for(var f=0;f<u-d;f++)o.push({x:m,y:f});for(var g=0;g<e;){var y=parseInt(Math.random()*(t/2))+n,v=parseInt(Math.random()*(t/2))+a,b=parseInt(Math.random()*o.length);i.push({x:t*o[b].x+y,y:t*o[b].y+v}),o.splice(b,1),g++}return i},s=function(){var e=navigator.userAgent,t=/(?:Windows Phone)/.test(e),n=/(?:SymbianOS)/.test(e)||t,a=/(?:Android)/.test(e),r=/(?:Firefox)/.test(e),s=(/(?:Chrome|CriOS)/.test(e),/(?:iPad|PlayBook)/.test(e)||a&&!/(?:Mobile)/.test(e)||r&&/(?:Tablet)/.test(e)),i=/(?:iPhone)/.test(e)&&!s,o=!i&&!a&&!n,c=e.toLowerCase().match(/(msie|firefox|chrome|opera|version).*?([\d.]+)/);return{isTablet:s,isPhone:i,isAndroid:a,isPc:o,browser:c[1].replace(/version/,"'safari"),version:c[2]}}},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n("cwe7"),n("+BTi");var a=n("2X9z"),r=n.n(a),s=(n("oq7i"),n("+TD8")),i=n.n(s),o=(n("Yq4J"),n("qubY")),c=n.n(o),u=(n("Rh7U"),n("pkKZ")),l=n.n(u),h=(n("Q6SQ"),n("LQMI")),p=n.n(h),d=(n("jZDA"),n("91Nw")),m=n.n(d),f=(n("d7TW"),n("ajQY")),g=n.n(f),y=(n("GXEp"),n("mtrD")),v=n.n(y),b=(n("NOFV"),n("mWcH")),w=n.n(b),T=(n("ZzA9"),n("cgIP")),k=n.n(T),S=(n("H3rH"),n("6mNG")),I=n.n(S),O=n("7+uW"),E=n("JaHG"),x={name:"App",data:function(){return{showInfo:!1}},mounted:function(){var e=this,t=document.getElementById("app-loading");t&&document.body.removeChild(t),setTimeout(function(){e.checkGoogleChromeTouch()},0)},methods:{checkGoogleChromeTouch:function(){var e=this;if(navigator.maxTouchPoints>0){console.log("checkGoogleChromeTouch()");var t=Object(E.b)();if(!t.isPc||"chrome"!==t.browser)return;var n=t.version.split(".");if(!n||0===n.length)return;parseInt(n[0])>65&&!("ontouchend"in window)&&(this.showInfo=!0,setTimeout(function(){e.$refs.infoEle.classList.add("touch-set-info-anime")},300),setTimeout(function(){e.showInfo=!1},1e4))}}}},C={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("keep-alive",{attrs:{include:"HomePage"}},[n("router-view")],1),e._v(" "),e.showInfo?n("div",{ref:"infoEle",staticClass:"touch-set-info"},[e._m(0),e._v(" "),n("p",[e._v("打开‘Touch Events API’后重启浏览器，以支持屏幕触摸事件")]),e._v(" "),n("span",{staticClass:"info-close",on:{click:function(t){e.showInfo=!1}}},[e._v("关闭")])]):e._e()],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("请在本浏览器新建标签输入\n      "),t("span",{staticClass:"msg"},[this._v("chrome://flags/#touch-events")]),this._v("回车")])}]};var j=n("VU/8")(x,C,!1,function(e){n("cqt9")},null,null).exports,A=n("/ocq"),_={template:"<div></div>",created:function(){var e=this.$route,t=e.query;window.iexFullPath=e.fullPath,sessionStorage.setItem("teacherId",t.teacherId),sessionStorage.setItem("accessToken",t.accessToken),sessionStorage.setItem("subjectId",t.subjectId),sessionStorage.setItem("periodId",t.periodId),sessionStorage.setItem("moment",t.moment),sessionStorage.setItem("termFlag",t.termFlag),sessionStorage.setItem("gradeId",t.gradeId),sessionStorage.setItem("aio",t.aio);var n=t.type,a=t.resourceId,r="1"===t.F_type,s=!1;"0"===n&&t.teacherId&&"0"!==t.teacherId&&(s=!0),sessionStorage.setItem("isTeacher",s),this.$root.isTeacher=s,"0"===n?this.$router.push({path:"/home"}):"1"===n&&this.$router.push({path:"/exploration/display/"+a+"?displayOnly="+t.displayOnly+"&bodyColor="+t.bodyColor+"&needExit="+r})}};O.default.use(A.a);var M=new A.a({routes:[{path:"/index",component:_},{path:"/home",name:"HomePage",component:function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"wrM5"))}},{path:"/exploration/:sectionMode/:id",name:"Exploration",component:function(){return n.e(1).then(n.bind(null,"VyiP"))}},{path:"/*",redirect:"/home"}]}),P=n("8+8L"),F=(n("tvR6"),n("bOdI")),X=n.n(F),D=n("pFYg"),Y=n.n(D),B=n("mvHQ"),$=n.n(B),W=n("BO1k"),R=n.n(W),q=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];console.log(e);var a=e.$refs.ddmrrDom.firstElementChild.querySelector("span"),r=a.innerText;("0"!=r||n)&&(a.innerText=n?parseInt(r,10)+t:parseInt(r,10)-t)},L=function(e,t){switch(e.params.id){case"chicken":e.params.inCage=!0,t.forEach(function(e){switch(e.params.wareType){case"area-number-chicken-text":case"area-number-head-text":q(e,1);break;case"area-number-leg-text":q(e,2)}});break;case"rabbit":e.params.inCage=!0,t.forEach(function(e){switch(e.params.wareType){case"area-number-rabbit-text":case"area-number-head-text":q(e,1);break;case"area-number-leg-text":q(e,4)}})}},U=function(e,t){switch(e.params.id){case"chicken":e.params.inCage&&(e.params.inCage=!1,t.forEach(function(e){switch(e.params.wareType){case"area-number-chicken-text":case"area-number-head-text":q(e,1,!1);break;case"area-number-leg-text":q(e,2,!1)}}));break;case"rabbit":if(e.params.inCage){e.params.inCage=!1,t.forEach(function(e){switch(e.params.wareType){case"area-number-rabbit-text":case"area-number-head-text":q(e,1,!1);break;case"area-number-leg-text":q(e,4,!1)}});break}}},N=n("R3KO");function V(e,t){this.root=e,this.type=t,this.areas=[],this.moveingObjs=[],this.counters=[],this.instanceCount=0,this.counts=null,this.random=null,this.isAutoSort=!1,this.changApply=!1,this["init"+t]&&this["init"+t](),"triangle"===this.type||"chickenRabbitSameCage"===this.type||"pigeonWithCage"===this.type||"land"===this.type||"shape"===this.type?this.root.editorManager.setSubmitShow(!1):this.root.editorManager.setSubmitShow(!0)}V.prototype={name:"wareSort",constructor:V,addInstance:function(e){"normal"!==e.params.wareType&&(e.params.wareType.indexOf("counts")>-1?this.counts=e:e.params.wareType.indexOf("random")>-1?(this.random=e,this.root.isTeacher||e.setParams({opacity:0})):0===e.params.wareType.indexOf("area-")?(this.areas.push(e),e.wareTargets=[],1===this.areas.length&&(this.isAutoSort="area-"===e.params.wareType,console.log("isAutoSort="+this.isAutoSort))):e.params.isCounter?this.counters.push(e):(this.moveingObjs.push(e),e.wareArea=null),e.wareObj=this)},checkSelectedInstance:function(e){return!e.params.isCounter&&(!(e.params.wareType.indexOf("counts")>-1)&&(e.params.wareType.indexOf("random")>-1&&1===e.params.opacity?(this.randomChangeBeads(),!1):-1===e.params.wareType.indexOf("area")))},setSectionMode:function(e){var t=this;this["reset"+this.type]&&this["reset"+this.type](e),this.moveingObjs.forEach(function(e){e.wareArea=null,e.canDisplaySelect=!0,e.params.preTransX&&(e.params.transX=e.params.preTransX),e.params.preTransY&&(e.params.transY=e.params.preTransY),e.params.preWidth&&(e.params.width=e.params.preWidth),e.params.preHeight&&(e.params.height=e.params.preHeight)}),this.loopDestroyCounterCopy(),this.counters.forEach(function(e){e.cCurCount=e.params.cCount}),this.areas.forEach(function(e){e.wareTargets=[]}),this.instanceCount=0,"edit"===e?this.moveingObjs.forEach(function(e){e.fitTypeScale<0&&(e.fitTypeScale/=-1,e.params.width=e.params.width/e.fitTypeScale,e.params.height=e.params.height/e.fitTypeScale)}):"display"===e&&this.moveingObjs.forEach(function(e){t.ddmrrMoveEnd(e,!0)&&(e.canDisplaySelect=!1)})},loopDestroyCounterCopy:function(){var e=0;this.moveingObjs.forEach(function(t){t.counter&&e++});var t=!1;if(e>0)for(var n=0;n<this.moveingObjs.length;n++)if(this.moveingObjs[n].counter){this.moveingObjs[n].destroyCounterCopy(!0),t=!0;break}t&&this.loopDestroyCounterCopy()},checkApply:function(){return this.changApply?1:0},resetChangeApply:function(){this.root.editorManager.resetChangeApply()},setChosedCount:function(e){N.a.afterGetNumber(this,e)},randomChangeBeads:function(){this.moveingObjs.forEach(function(e){e.deleteSelf()}),this.moveingObjs=[],console.log(this.counters[0].parentElement);var e=JSON.parse($()(this.counters[0].params));this.root.editorManager.setSelectedObject({instance:this.counters[0],type:0}),this.root.editorManager.delete(),this.counters=[],this.root.editorManager.loadBlockData(e);for(var t=[],n=0,a=0;a<3;a++){var r=10*Math.random();n+=r=parseInt(r,10),t.push(r)}this.counts.params.html=t[0]+"&nbsp;&nbsp;&nbsp;&nbsp;"+t[1]+"&nbsp;&nbsp;&nbsp;&nbsp;"+t[2],this.counters[0].params.cCount=n,this.counters[0].setSectionMode("display"),this.areas.forEach(function(e,n){e.params.wareType="area-bead-"+t[n],e.wareTargets=[]}),this.resetChangeApply()},initbead:function(){console.log("initbead"),this.root.isTeacher&&(this.changApply=!0,console.log(this.random))},initsquare9:function(){var e=this;if(console.log("initsquare9"),this.root.isTeacher&&(this.changApply=!0,!this.square9Btn)){var t=document.createElement("IMG");t.style.position="absolute",t.style.bottom="5%",t.style.left="18%",t.style.zIndex="100",t.setAttribute("src","./static/images/question-next.png"),this.root.editorManager.getSectionEle().append(t),t.addEventListener("click",function(t){t.stopPropagation(),e.changeSquare9()}),this.square9Btn=t}},changeSquare9:function(){var e=this;if(this.root.isTeacher){void 0===this.square9Type&&(this.square9Type=0),this.resetChangeApply(),this.setSectionMode("edit");var t=720,n=250,a=[],r=[[63,30,33,20,-10,-10,43,-20,-23],[2,-3,6,4,5,-20,8,-15,-120],[-1,-4,9,-16,25,-36,-49,64,81],[-2,-6,12,20,30,-42,-56,72,-90],[15,-1,11,5,9,13,-7,-17,3],[15,20,13,-14,16,-18,-19,12,17],[-24,-33,42,-51,60,69,-78,87,-96],[7,-10,15,22,33,-46,-61,-78,-97],[3,2,6,8,14,-22,-36,-58,-94],[88,-80,72,-64,-56,48,-40,-32,24]];this.square9Type++,this.square9Type>=r.length&&(this.square9Type=0);var s=r[this.square9Type];s.forEach(function(e){e<0&&(a.push({x:t,y:n}),(t+=120)>1060&&(t=720,n+=150))}),s.forEach(function(t,n){var r=e.moveingObjs[n].params,s=e.areas[n].params;if(t>0)r.html=""+t,r.transX=s.transX+s.width/2-r.width/2,r.transY=s.transY+s.height/2-r.height/2,e.moveingObjs[n].canDisplaySelect=!1,e.areas[n].params.backgroundColor="#ccc";else{r.html=""+-t;var i=parseInt(Math.random()*a.length);r.transX=a[i].x,r.transY=a[i].y,e.moveingObjs[n].canDisplaySelect=!0,a.splice(i,1),e.areas[n].params.backgroundColor="white"}r.wareType=""+(n+1),r.preTransX=r.transX,r.preTransY=r.transY}),this.setSectionMode(this.root.editorManager.sectionMode)}},resetsquare9:function(e){this.root.isTeacher&&(this.square9Btn||this.initsquare9())},releasesquare9:function(){this.square9Btn&&this.square9Btn.parentElement&&this.square9Btn.remove(),this.square9Btn=null},resetshape:function(){"shape"===this.type&&(console.log("resetshape() "+this.shapeStep),this.shapeStep&&(this.root.editorManager.getSection().components.forEach(function(e){e.params&&e.params.type&&"block-text"===e.params.type&&e.params.preOpacity&&(e.params.opacity=e.params.preOpacity)}),this.moveingObjs.forEach(function(e){e.params.preScale&&(e.params.scale=e.params.preScale)}),this.shapeStep=0,this.areas.forEach(function(e,t){if(e.params.transX=e.params.preTransX,e.params.transY=e.params.preTransY,e.params.width=e.params.preWidth,e.params.height=e.params.preHeight,e.children&&e.children.length>0){var n=e.children[0];n.params.transX=n.params.preTransX,n.params.transY=n.params.preTransY,n.params.fontSize=n.params.preFontSize}e.wareTargets.forEach(function(e){e.params.transX=e.params.preTransX,e.params.transY=e.params.preTransY,e.showErrorImg=!1})})))},ddmrrMoveEnd:function(e,t){var n=this;if(console.log("ddmrrMoveEnd()"),!t){if(0===e.ddmrrStep)return;if("display"!==e.sectionMode)return e.params.preTransX=e.params.transX,void(e.params.preTransY=e.params.transY)}var a=this.areas.find(function(t){var a=e.params.width/2;if(t.params.transX-a<=e.params.transX&&e.params.transX<t.params.transX+t.params.width-a){var r=e.params.height/2;if(t.params.transY-r<=e.params.transY&&e.params.transY<t.params.transY+t.params.height-r)return!0}return"pigeonWithCage"!==n.type&&"chickenRabbitSameCage"!==n.type||n.afterDragFail(e,t,n.areas),!1}),r=-1;if(a)if(this.isAutoSort&&"area-"===a.params.wareType&&(a.params.wareType="area-"+e.params.wareType),this.checkContain(a,e)>-1){if(r=1,"pigeonWithCage"!==this.type&&"chickenRabbitSameCage"!==this.type||setTimeout(function(){return n.afterDragSucc(e,a,n.areas)},0),e.wareArea){if(e.wareArea!==a){var s=e.wareArea.wareTargets.findIndex(function(t){return t===e});e.wareArea.wareTargets.splice(s,1),"bead"===this.type&&e.wareArea.wareTargets.forEach(function(e,t){t>=s&&(e.params.transY+=e.params.height)}),this.isAutoSort&&0===e.wareArea.wareTargets.length&&(e.wareArea.params.wareType="area-"),a.wareTargets.push(e)}else if(console.log("It is now in this area"),"bead"===this.type){var i=e.params.width,o=e.params.height,c=a.params.width,u=a.params.height,l=a.wareTargets.findIndex(function(t){return t===e});return e.params.transX=a.params.transX+c/2-i/2,e.params.transY=a.params.transY+u-o*(l+1),e.releaseDdmrr(),void e.$root.editorManager.setSelectedObject(null)}this.instanceCount--}else a.wareTargets.push(e);if(this.instanceCount++,e.wareArea=a,"photo"===this.type){var h=a.wareTargets.find(function(t){return t.params.wareType===e.params.wareType});console.log("check photo is has one: "+(h!==e)+" "+a.wareTargets.length),h!==e&&(r=-1)}}else r=0;if(1!==r&&e.wareArea){var p=e.wareArea.wareTargets.findIndex(function(t){return t===e});e.wareArea.wareTargets.splice(p,1),"bead"===this.type?e.wareArea.wareTargets.forEach(function(e,t){t>=p&&(e.params.transY+=e.params.height)}):"carrot"===this.type&&(e.params.preWidth&&(e.params.width=e.params.preWidth,e.params.preWidth=void 0),e.params.preHeight&&(e.params.height=e.params.preHeight,e.params.preHeight=void 0)),this.isAutoSort&&0===e.wareArea.wareTargets.length&&(e.wareArea.params.wareType="area-"),e.wareArea=null,this.instanceCount--,2===e.params.fitType?(e.params.width=e.params.width/e.fitTypeScale,e.params.height=e.params.height/e.fitTypeScale):4===e.params.fitType&&e.fitTypeScale<0&&(e.fitTypeScale/=-1,e.params.width=e.params.width/e.fitTypeScale,e.params.height=e.params.height/e.fitTypeScale)}if("clock"!==this.type){if(e.releaseDdmrr(),1===r){if(this.checkFitType(e,a),"shape"===this.type){e.canDisplaySelect=!1;anime({targets:a.$refs.ddmrrDom,translateX:[a.params.transX,a.params.transX],translateY:[a.params.transY,a.params.transY],rotate:[a.params.rotate],scale:[a.params.scale,a.params.scale+.3,a.params.scale],easing:"linear",duration:500}),anime({targets:e.$refs.ddmrrDom,translateX:[e.params.transX,e.params.transX],translateY:[e.params.transY,e.params.transY],rotate:[e.params.rotate,e.params.rotate],scale:[e.params.scale,0],easing:"linear",duration:300,delay:300,complete:function(t){e.params.preScale=e.params.scale,e.params.scale=0,n.checkShapeAutoSubmit()}})}else if("carrot"===this.type){var d=a,m=d.params.transX+20,f=d.params.transY+.4*d.params.height,g=d.wareTargets.length,y=Math.ceil(g/4);0===y&&(y=1);var v=(d.params.width-40)/3,b=(d.params.height,v);console.log("*** sS="+b+" lines="+y),d.wareTargets.forEach(function(e,t){e.params.transX=m,e.params.transY=f;var n=b/e.params.width;e.params.preWidth||(e.params.preWidth=e.params.width,e.params.preHeight=e.params.height),e.params.width=e.params.width*n,e.params.height=e.params.height*n,(m+=e.params.width*n-v/4)>d.params.transX+d.params.width-.8*v&&(m=d.params.transX+v/4,f+=b)})}else if("photo"===this.type){var w=a.params.transX+30+40,T=a.params.transY+50;a.wareTargets.forEach(function(e){e.params.transX=w-e.params.width/2,e.params.transY=T+(120-e.params.height),w+=80})}else"triangle"!==this.type&&"land"!==this.type||this.instanceCount===this.moveingObjs.length&&this.root.editorManager.autoSubmit();return!0}0===r||this.areas.forEach(function(t){var a=t.wareTargets.findIndex(function(t){return t===e});a>-1&&(t.wareTargets.splice(a,1),n.instanceCount--)}),"clock"!==this.type&&setTimeout(function(){e.counter&&(e.canDisplaySelect=!1);var t=Math.pow(e.params.transX-e.params.preTransX,2);t+=Math.pow(e.params.transY-e.params.preTransY,2);var a=t=Math.sqrt(t);anime({targets:e.$refs.ddmrrDom,translateX:[e.params.transX,e.params.preTransX],translateY:[e.params.transY,e.params.preTransY],rotate:[e.params.rotate,e.params.rotate],easing:"linear",duration:a,complete:function(t){if(e.counter){var a=n.moveingObjs.findIndex(function(t){return t===e});-1!==a&&n.moveingObjs.splice(a,1),e.destroyCounterCopy()}}})},0)}},checkShapeAutoSubmit:function(){"shape"===this.type&&(this.shapeStep=1,console.log("checkShapeAutoSubmit()"),this.instanceCount===this.moveingObjs.length&&(this.root.editorManager.autoSubmit(),this.shapeStep=2))},checkFitType:function(e,t){if(e.params.fitType&&"carrot"!==this.type){var n=e.params.width,a=e.params.height,r=t.params.width,s=t.params.height;if(2===e.params.fitType){var i=1;if(n>r-20&&(i*=(r-20)/n,n=r-20,a*=i),a>s-20){var o=(s-20)/a;a=s-20,n*=o,i*=o}e.params.width=n,e.params.height=a,e.fitTypeScale=i}var c=t.params.transX+r/2-n/2,u=void 0;if(3===e.params.fitType){var l=t.wareTargets.length;u=t.params.transY+s-a*l}else u=t.params.transY+s/2-a/2;e.params.transX=c,e.params.transY=u}},checkContain:function(e,t){return"shape"===this.type||"square9"===this.type?"square9"===this.type&&e.wareTargets&&e.wareTargets.length>0?-1:0:"bead"===this.type?e.wareTargets.length>=9?-1:1:e.params.wareType.indexOf(t.params.wareType)},removeInstance:function(e){if("normal"!==e.params.wareType)if(e.params.wareType.indexOf("area")>-1){var t=this.areas.findIndex(function(t){return t===e});t>-1&&(this.areas[t].wareObj=null,this.areas[t].wareTargets&&(this.areas[t].wareTargets=null),this.areas.splice(t,1))}else if(e.params.isCounter){var n=this.areas.findIndex(function(t){return t===e});n>-1&&(this.counters[n].wareObj=null,this.counters.splice(n,1))}else{var a=this.moveingObjs.findIndex(function(t){return t===e});a>-1&&(this.moveingObjs[a].wareObj=null,this.moveingObjs[a].wareArea&&(this.moveingObjs[a].wareArea=null),this.moveingObjs.splice(a,1))}},submit:function(){var e=this;if("triangle"===this.type||"land"===this.type)return this.moveingObjs.length===this.instanceCount?3:4;if("shape"===this.type)return this.submitShape();if("shape2"===this.type){var t="";this.areas.forEach(function(e){t+=e.params.wareType});var n=0;return this.moveingObjs.forEach(function(e){t.indexOf(e.params.wareType)>-1&&n++}),n===this.instanceCount?1:0}if("square9"===this.type)return this.sutmitSquare9();if("rocket"==this.type){if(this.moveingObjs.length===this.instanceCount){for(var a=this.moveingObjs,r=a.length,s=!1,i=0;i<r;i++)if(a[i].wareArea.params.wareType.indexOf("target")>0){s=!0;break}return s?3:4}return 4}if("orange"===this.type)return this.moveingObjs.length===this.instanceCount&&this.areas.every(function(t){return t.wareTargets.length===e.moveingObjs.length/e.areas.length})?3:4;if("bead"===this.type){var o=3,c=!0,u=!1,l=void 0;try{for(var h,p=R()(this.areas);!(c=(h=p.next()).done);c=!0){var d=h.value;if(parseInt(d.params.wareType.split("-").pop())!==d.wareTargets.length){o=4;break}console.log(d)}}catch(e){u=!0,l=e}finally{try{!c&&p.return&&p.return()}finally{if(u)throw l}}return o}if("pinyin"===this.type)return this.moveingObjs.length===this.instanceCount&&this.areas.every(function(e){return e.wareTargets[0]&&e.params.py===e.wareTargets[0].params.py})?3:4;if("pigeonWithCage"===this.type){var m=this.areas.find(function(e){return!!e.params.id&&"titleofpigeon"==e.params.id}).$refs.ddmrrDom.querySelector("#pigeonnumber");return console.log(m.rightValue,m.value),m.rightValue&&m.rightValue==m.value?3:4}return 0},submitShape:function(){if("shape"!==this.type)return-2;if(this.root.editorManager.getSection().components.forEach(function(e){e.params&&e.params.type&&"block-text"===e.params.type&&(e.params.preOpacity=e.params.opacity,e.params.opacity=0)}),this.instanceCount===this.moveingObjs.length){var e=0,t=[{x:212,y:170},{x:668,y:170},{x:212,y:420},{x:668,y:420}];return this.areas.forEach(function(n,a){if(n.params.preTransX=n.params.transX,n.params.preTransY=n.params.transY,n.params.transX=t[a].x,n.params.transY=t[a].y,n.params.preWidth=n.params.width,n.params.preHeight=n.params.height,n.params.width=400,n.params.height=235,n.children&&n.children.length>0){var r=n.children[0];r.params.preTransX=r.params.transX,r.params.preTransY=r.params.transY,r.params.transY=0,r.params.transX=(n.params.width-r.params.width)/2,r.params.preFontSize=r.params.fontSize,r.params.fontSize=32}var s=n.params.transX+20,i=n.params.transY+50,o=n.wareTargets.length,c=Math.ceil(o/5);0===c&&(c=1);var u=165/c,l=72>u?u:72;console.log("*** sS="+l+" lines="+c),n.wareTargets.forEach(function(t,a){t.params.transX=s,t.params.transY=i,(t.params.width>l||t.params.height>l)&&(t.params.width>t.params.height?t.params.scale=l/t.params.width:t.params.scale=l/t.params.height,t.params.transX-=(1-t.params.scale)*t.params.width/2,t.params.transY-=(1-t.params.scale)*t.params.height/2),s+=l,a>0&&(a+1)%5==0&&(s=n.params.transX+20,i+=l);var r=t.params.wareType;n.params.wareType.indexOf(r)>0?e++:t.showErrorImg=!0})}),e===this.instanceCount?1:2}return 2},sutmitSquare9:function(){if("square9"!==this.type)return-2;if(this.instanceCount===this.moveingObjs.length){var e=0;return this.areas.forEach(function(t){if(t.wareTargets&&1===t.wareTargets.length){var n=t.wareTargets[0].params.wareType;t.params.wareType.indexOf(n)>0&&e++}}),e===this.instanceCount?3:4}return 4},release:function(){this.areas.forEach(function(e){e.wareObj=null}),this.moveingObjs.forEach(function(e){e.wareObj=null,e.wareArea=null}),this.counters.forEach(function(e){e.wareObj=null}),this["release"+this.type]&&this["release"+this.type](),this.root=null,this.areas=null,this.moveingObjs=null,this.counters=null},afterDragSucc:function(e,t,n){"chickenRabbitSameCage"===this.type&&L(e,n),"pigeonWithCage"===this.type&&N.a.afterDrag(e,t,n)},afterDragFail:function(e,t,n){"chickenRabbitSameCage"===this.type&&U(e,n),"pigeonWithCage"===this.type&&N.a.afterDragFail(e,t,n)}};var H=V,G=n("s1Q5");function z(e,t){this.root=e,this.type=t,this.instances=[],this.changApply=!1,console.log("WareElement() "+t),this["init"+t]&&this["init"+t](),"fastener"===this.type||"tangram"===this.type||"planting"===this.type||"calculating"===this.type||-1!==this.type.indexOf("house")?this.root.editorManager.setSubmitShow(!0):(this.root.editorManager.setSubmitShow(!1),"symmetry"!==this.type||this.root.isTeacher||this.root.editorManager.setSubmitShow(!0))}z.prototype={name:"WareElement",constructor:z,addInstance:function(e){e.params&&"normal"!==e.params.wareType&&(this.instances.push(e),e.wareObj=this)},removeInstance:function(e){var t=this.instances.findIndex(function(t){return e===t});return!(t>-1)||(e.removeSelectObj?!!e.removeSelectObj()&&(this.instances.splice(t,1),!0):(this.instances.splice(t,1),!0))},setSectionMode:function(e){this.instances.forEach(function(t){t.sectionMode&&(t.sectionMode=e)}),this["reset"+this.type]&&this["reset"+this.type](e)},checkApply:function(){return this.changApply?1:0},resetChangeApply:function(){this.root.editorManager.resetChangeApply()},initcalculating:function(){this.changApply=!0},initsymmetry:function(){this.changApply=!0},initmindmap:function(){this.changApply=!0},initwaterinjection:function(){this.changApply=!0},initfastener:function(){var e=this;if(this.root.isTeacher&&(this.changApply=!0,!this.dialogFastener)){var t="dialog-fastener";-1===G.a[t]?(G.a[t]=0,G.a.getImport(t).then(function(n){O.default.component(t,n.default),G.a[t]=1,e.dialogFastener=e.root.editorManager.addBlockElement(void 0,t,!0),e.dialogFastener.setWareObj(e)}).catch(function(e){console.log("import error::"+t,e)})):1===G.a[t]&&(this.dialogFastener=this.root.editorManager.addBlockElement(void 0,t,!0),this.dialogFastener.setWareObj(this))}},resetfastener:function(e){this.dialogFastener||this.initfastener()},releasefastener:function(){this.dialogFastener&&(this.dialogFastener.$el.remove(),this.dialogFastener.$root=null,this.dialogFastener.$destroy())},checkSelectedInstance:function(e){return!0},ddmrrMoveEnd:function(e){},submit:function(){var e=-1;if(this.instances.forEach(function(t){t.submit&&(e=t.submit())}),-1!==this.type.indexOf("house")&&e&&e instanceof Array){var t="";return e.forEach(function(e){e.value?t+="1":t+="0"}),6===e.length?"100110"===t?3:4:7===e.length&&"0010011"===t?3:4}return"tangram"===this.type||"fastener"===this.type?0:e},resetParams:function(){this.instances.forEach(function(e){e.resetParams&&e.resetParams()})},release:function(){this.instances.forEach(function(e){e.wareObj=null}),this["release"+this.type]&&this["release"+this.type](),this.root=null}};var J=z,Q=n("woOf"),Z=n.n(Q);function K(e,t){this.root=e,this.type=t,this.counts=[],this.numObjs=[],this.moveingObjs=[],this.selectedInstance=null,this.sectionMode="",this.chosedType="",this.random=null,this.changApply=!1,this["init"+t]&&this["init"+t](),this.root.editorManager.setSubmitShow(!0)}K.prototype={name:"WareBlank",constructor:K,addCount:function(e){this.counts.push(e)},addInstance:function(e){e.params.wareType&&0===e.params.wareType.indexOf("blank-")&&(0===e.params.wareType.indexOf("blank-move")?this.moveingObjs.push(e):0===e.params.wareType.indexOf("blank-num")?(this.numObjs.push(e),this.counts.push("")):e.params.wareType.indexOf("replace")>-1&&(this.random=e,this.root.isTeacher||e.setParams({opacity:0})),e.sectionType="ware-blank",e.wareObj=this)},resetChangeApply:function(){this.root.editorManager.resetChangeApply()},checkApply:function(){return this.changApply?1:0},setSelected:function(e,t){t?e.setParams({borderColor:"rgba(255,0,0,1)"}):e.setParams({borderColor:"vegetable"===this.type?"#009CFF":"#bfbfbf"})},initcash:function(){this.root.isTeacher&&(this.changApply=!0)},checkSelectedInstance:function(e){return e.params.wareType.indexOf("blank-replace")>-1&&1===e.params.opacity?(this.replaceInstances(),!1):e.params.wareType.indexOf("blank-num")>-1?(this.setSelectedInstance(e),!1):e.params.wareType.indexOf("blank-move")>-1||void 0},checkSelectedEditInstance:function(e){return!("area"===this.type&&e.params.wareType.indexOf("blank-area-grid")>-1)},setSelectedInstance:function(e){null!==this.selectedInstance&&this.setSelected(this.selectedInstance,!1),this.setSelected(e,!0),this.selectedInstance=e,this.chosedType=e.params.wareType.split("-").pop(),this.root.editorManager.showCounter(this.setChosedCount,this)},setChosedCount:function(e){var t=this;if("confirm"===e)this.root.editorManager.hideCounter(),this.setSelected(this.selectedInstance,!1),this.selectedInstance=null;else{var n=this.numObjs.findIndex(function(e){return e.params.wareType.indexOf(t.chosedType)>-1});"area"===this.type?this._handleCountStr(e,n):"cash"===this.type?this._handleCountStr(e,n):"vegetable"===this.type&&(this.counts[n]=e,this.selectedInstance.params.html=e)}},replaceInstances:function(){var e=this;this.numObjs.forEach(function(e){e.params.html=""}),this.counts=this.counts.map(function(e){return""});var t=this.root.editorManager.sections[0].components.filter(function(e){return!e.params.wareType||-1===e.params.wareType.indexOf("blank-move")});this.root.editorManager.sections[0].components=t,this.moveingObjs.forEach(function(e){e.deleteSelf()}),this.moveingObjs=[];for(var n=Math.floor(3*Math.random())+5,a=te.cash,r=[],s=0;s<n;s++){var i=Math.floor(10*Math.random());r.push(i)}var o=[];r.forEach(function(e){var t=Z()({},a[e]);o.push(t)});var c=0,u=0;o.forEach(function(e,t,n){var a=e.width;t<=3?(e.transX+=c,c+=a,c+=20):(e.transX+=u,u+=a,u+=20,e.transY=420)}),o.forEach(function(t){var n=JSON.parse($()(t));e.root.editorManager.loadBlockData(n)}),this.root.editorManager.resetSections(),this.resetChangeApply()},_handleCountStr:function(e,t){""===e&&this.counts[t].length?this.counts[t]=this.counts[t].substr(0,this.counts[t].length-1):this.counts[t].length<3&&(this.counts[t]+=e),this.selectedInstance.params.html=this.counts[t]},ddmrrMoveEnd:function(e){e.releaseDdmrr();var t=e.params;t.transX,t.transY,t.width,t.height},submit:function(){var e=this;if(null!==this.selectedInstance&&(this.setSelected(this.selectedInstance,!1),this.selectedInstance=null),"cash"===this.type){var t=0;this.moveingObjs.forEach(function(e){t+=parseFloat(e.params.wareType.split("-").pop())});var n=3,a=t.toFixed(1).split(".");return this.counts.every(function(e,t){return a[t]===e||(n=4,!1)}),n}if("vegetable"===this.type){var r=3;return this.numObjs.every(function(t,n){return t.params.wareType.split("-").pop()===e.counts[n]||(r=4,!1)}),r}if("area"===this.type)return console.log(this.counts[0]),this.counts[0]>=17&&this.counts[0]<=18?3:4},setSectionMode:function(e){var t=this;this.sectionMode=e,"edit"===e&&(this.moveingObjs.forEach(function(e){e.params.transX=e.params.preTransX,e.params.transY=e.params.preTransY}),this.numObjs.forEach(function(e){e.setParams({html:""}),t.setSelected(e,!1)}),this.selectedInstance=null)},removeInstance:function(e){if("block-element"!==e.params.wareType)if(e.params.wareType.indexOf("blank-num")>-1){var t=this.numObjs.findIndex(function(t){return t===e});t>-1&&(this.numObjs[t].wareObj=null,this.numObjs.splice(t,1))}else{var n=this.moveingObjs.findIndex(function(t){return t===e});n>-1&&(this.moveingObjs[n].wareObj=null,this.moveingObjs.splice(n,1))}},release:function(){this.numObjs.forEach(function(e){e.wareObj=null}),this.moveingObjs.forEach(function(e){e.wareObj=null}),this.root=null,this.counts=null,this.selectedInstance=null,this.numObjs=null,this.moveingObjs=null}};var ee=K,te={cash:[{name:"block-element",type:"block-image",wareType:"blank-move-0.1",src:"./static/images/cash/cash-one-jiao.png",transX:60,transY:200,preTransX:60,preTransY:200,width:213,height:98},{name:"block-element",type:"block-image",wareType:"blank-move-0.2",src:"./static/images/cash/cash-two-jiao.png",transX:60,transY:200,preTransX:60,preTransY:200,width:219,height:99},{name:"block-element",type:"block-image",wareType:"blank-move-0.5",src:"./static/images/cash/cash-five-jiao.png",transX:60,transY:200,preTransX:60,preTransY:200,width:215,height:102},{name:"block-element",type:"block-image",wareType:"blank-move-1",src:"./static/images/cash/cash-one-yuan.png",transX:60,transY:200,preTransX:60,preTransY:200,width:253,height:120},{name:"block-element",type:"block-image",wareType:"blank-move-2",src:"./static/images/cash/cash-two-yuan.png",transX:60,transY:200,preTransX:60,preTransY:200,width:242,height:109},{name:"block-element",type:"block-image",wareType:"blank-move-5",src:"./static/images/cash/cash-five-yuan.png",transX:60,transY:200,preTransX:60,preTransY:200,width:278,height:133},{name:"block-element",type:"block-image",wareType:"blank-move-10",src:"./static/images/cash/cash-ten-yuan.png",transX:60,transY:200,preTransX:60,preTransY:200,width:273,height:133},{name:"block-element",type:"block-image",wareType:"blank-move-20",src:"./static/images/cash/cash-twenty-yuan.png",transX:60,transY:200,preTransX:60,preTransY:200,width:276,height:133},{name:"block-element",type:"block-image",wareType:"blank-move-50",src:"./static/images/cash/cash-fifty-yuan.png",transX:60,transY:200,preTransX:60,preTransY:200,width:293,height:137},{name:"block-element",type:"block-image",wareType:"blank-move-100",src:"./static/images/cash/cash-hundred-yuan.png",transX:60,transY:200,preTransX:60,preTransY:200,width:307,height:154}]},ne=n("d7EF"),ae=n.n(ne);function re(e,t){this.root=e,this.type=t,this.index=this.root.editorManager.curIndex,this.root.editorManager.setSubmitShow(!1),this.instances=[],this.others=[],this.results=[],this.preInstance=null,this.preType="",this.linkCache=[],this.answer=[],this.areas=[],this.objs=[],this.nums=[]}re.prototype={addInstance:function(e){e.params.wareType&&0===e.params.wareType.indexOf("connect")&&(0===e.params.wareType.indexOf("connect-area")?(this.areas.push(e),e.wareTargets=[],e.count=0):e.params.wareType.indexOf("connect-obj")>-1||e.params.wareType.indexOf("connect-num")>-1?this.instances.push(e):e.params.wareType.indexOf("connect-result")>-1?this.results.push(e):(e.params.wareType="normal",this.others.push(e)),e.sectionType="ware-connect",e.wareObj=this)},checkSelectedInstance:function(e){if(e.params.wareType.indexOf("connect-obj")>-1||e.params.wareType.indexOf("connect-num")>-1){for(var t=!1,n=0;n<this.linkCache.length;n++)if(this.linkCache[n].indexOf(e)>-1){t=!0;break}return t||this.setSelectedInstance(e),!1}return!0},checkSelectedEditInstance:function(e){return!(e.params.wareType.indexOf("connect-area")>-1)},setSelectedInstance:function(e){var t=this;if(null===this.preInstance)this.preInstance=e,this.setSelected(!0,this.preInstance),this.preInstance.params.wareType.indexOf("connect-obj")>-1?this.preType="obj":this.preInstance.params.wareType.indexOf("connect-num")>-1&&(this.preType="num");else{if(this.preInstance===e)return;this.preInstance.params.wareType.split("-").pop()!==e.params.wareType.split("-").pop()?(this.setSelected(!1,this.preInstance),this.setSelected(!0,e),this.preInstance=e):(this.setSelected(!0,e),this.linkCache.push([this.preInstance,e]),this.playAnime(this.preInstance,e)),this.linkCache.length===this.instances.length/2&&setTimeout(function(){t.setResult()},1e3)}},setSelected:function(e,t){e?(t.anime=this.shake(t),t.anime.play()):t.anime&&(t.anime.pause(),t.$refs.ddmrrDom.style.transform="")},playAnime:function(e,t){var n=this;setTimeout(function(){e.anime.pause(),e.$refs.ddmrrDom.style.transform="",e.setParams({opacity:"0"}),t.anime.pause(),t.$refs.ddmrrDom.style.transform="",t.setParams({opacity:"0"}),n.firework(e,t)},200)},computePos:function(e,t){var n=e.params,a=n.left,r=void 0===a?0:a,s=n.top,i=void 0===s?0:s,o=n.transX,c=n.transY,u=n.width,l=n.height,h=n.wareType,p=r+o+u/2,d=void 0;return"svg"===t?d=i+c+(h.includes("obj")?l+10:-10):"firework"===t&&(d=i+c+l/2),[p,d]},shake:function(e){return anime({targets:e.$refs.ddmrrDom,translateX:[{value:3,duration:100,delay:5,elasticity:0},{value:-3,duration:100,delay:5,elasticity:0},{value:3,duration:100,delay:5,elasticity:0},{value:-3,duration:100,delay:5,elasticity:0},{value:3,duration:100,delay:5,elasticity:0},{value:-3,duration:100,delay:5,elasticity:0}],rotate:[{value:.5,duration:100,easing:"easeInOutQuad"},{value:-.5,duration:100,easing:"easeInOutQuad"},{value:.5,duration:100,easing:"easeInOutQuad"},{value:-.5,duration:100,easing:"easeInOutQuad"},{value:.5,duration:100,easing:"easeInOutQuad"},{value:-.5,duration:100,easing:"easeInOutQuad"}],loop:!0,autoplay:!1})},firework:function(e,t){console.log("firework");var n=this.computePos(e,"firework"),a=ae()(n,2),r=a[0],s=a[1];console.log(r,s);var i=this.computePos(t,"firework"),o=ae()(i,2),c=o[0],u=o[1],l=this.root.editorManager.getSectionEle().querySelector("canvas"),h=l.getContext("2d");h.save();var p=["#FF324A","#31FFA6","#206EFF","#FFFF99"],d=[],m=function(e,t){var n={};return n.x=e,n.y=t,n.color=p[anime.random(0,p.length-1)],n.radius=10*Math.abs(Math.random())+10,n.draw=function(){h.beginPath(),h.arc(n.x,n.y,n.radius,0,2*Math.PI,!0),h.fillStyle=n.color,h.fill(),h.closePath()},n},f=function(e){var t=d.indexOf(e);t>-1&&d.splice(t,1)},g=function(e,t){var n=function(e,t){for(var n=[],a=0;a<40;a++){var r=m(e,t);n.push(r)}return n}(e,t),a=function(e,t){var n={};return n.x=e,n.y=t,n.color=p[anime.random(0,p.length-1)],n.color="#FFF",n.radius=0,n.alpha=1,n.lineWidth=6,n.draw=function(){h.globalAlpha=n.alpha,h.beginPath(),h.arc(n.x,n.y,n.radius,0,2*Math.PI,!0),h.lineWidth=n.lineWidth,h.strokeStyle=n.color,h.stroke(),h.globalAlpha=1},n}(e,t),r=anime({targets:n,x:function(e){return e.x+anime.random(-100,100)},y:function(e){return e.y+anime.random(-100,100)},radius:0,duration:function(){return anime.random(600,900)},easing:"easeOutExpo",complete:f}),s=anime({targets:a,radius:function(){return anime.random(105,135)},lineWidth:0,alpha:{value:0,easing:"linear",duration:function(){return anime.random(400,600)}},duration:function(){return anime.random(600,900)},easing:"easeOutExpo",complete:f});d.push(r),d.push(s)};g(r,s),g(c,u);var y=anime({duration:1/0,update:function(){h&&h.clearRect(0,0,l.width,l.height),d.forEach(function(e){e.animatables.forEach(function(e){e.target.draw()})})}});setTimeout(function(){y.pause()},2e3)},setResult:function(){this.root.editorManager.autoSubmit(),this.others.forEach(function(e){return e.setParams({opacity:0})}),this.results.forEach(function(e){return e.setParams({opacity:1})}),"animal"===this.type?this.linkCache.forEach(function(e,t){e.forEach(function(e){var n=void 0,a=void 0;0===t?(n=80,a=260):1===t?(n=680,a=260):2===t?(n=80,a=457):3===t&&(n=680,a=457),e.params.wareType.indexOf("num")>-1&&(n+=300),e.setParams({opacity:1,left:n,top:a,width:235,height:145})})}):"clock"===this.type&&this.linkCache.forEach(function(e,t){e.forEach(function(e){var n=void 0,a=void 0;0===t?(n=160,a=180):1===t?(n=750,a=180):2===t?(n=160,a=350):3===t?(n=750,a=350):4===t&&(n=160,a=520),e.params.wareType.indexOf("num")>-1&&(n+=221),e.setParams({left:n,top:a,width:156,height:150,opacity:1})})})},reset:function(){console.log("reset"),this.others.forEach(function(e){return e.setParams({opacity:1})}),this.results.forEach(function(e){return e.setParams({opacity:0})}),console.log(this.instances);var e=void 0,t=void 0;"animal"===this.type?(e=273,t=171):"clock"===this.type&&(e=223,t=215),this.instances.forEach(function(n){return n.setParams({left:n.params.preTransX,top:n.params.preTransY,width:e,height:t})}),this.linkCache=[]},ddmrrMoveEnd:function(e){console.log("ddmrrMoveEnd:")},submit:function(){return this.linkCache.length===this.instances.length/2?1:0},setAnswer:function(e){this.answer=e},setSectionMode:function(e){var t=this;console.log("secSectionMode "+e),"edit"===e&&(this.instances.forEach(function(e){t.setSelected(!1,e),e.setParams({opacity:1})}),this.linkCache=[],this.preInstance=null)},removeInstance:function(e){if("block-element"!==e.params.wareType){var t=this.instances.findIndex(function(t){return t===e});t>-1&&(this.instances[t].wareObj=null,this.instances.splice(t,1))}},release:function(){this.instances.forEach(function(e){e.wareObj=null}),this.preType="",this.linkCache=null,this.answer=null,this.root=null,this.preInstance=null,this.instances=null}};var se=re,ie=n("fZjL"),oe=n.n(ie),ce=n("//Fk"),ue=n.n(ce),le=function(){return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")},parseExtension:t,mimeType:function(e){var n=t(e).toLowerCase();return(a="application/font-woff",{woff:a,woff2:a,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml"})[n]||"";var a},dataAsUrl:function(e,t){return"data:"+t+";base64,"+e},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(e){return e.toBlob?new ue.a(function(t){e.toBlob(t)}):function(e){return new ue.a(function(t){for(var n=window.atob(e.toDataURL().split(",")[1]),a=n.length,r=new Uint8Array(a),s=0;s<a;s++)r[s]=n.charCodeAt(s);t(new Blob([r],{type:"image/png"}))})}(e)},resolveUrl:function(e,t){var n=document.implementation.createHTMLDocument(),a=n.createElement("base");n.head.appendChild(a);var r=n.createElement("a");return n.body.appendChild(r),a.href=t,r.href=e,r.href},getAndEncode:function(e){var t=3e4;fe.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());return new ue.a(function(n){var a,r=new XMLHttpRequest;if(r.onreadystatechange=function(){if(4!==r.readyState)return;if(200!==r.status)return void(a?n(a):i("cannot fetch resource: "+e+", status: "+r.status));var t=new FileReader;t.onloadend=function(){var e=t.result.split(/,/)[1];n(e)},t.readAsDataURL(r.response)},r.ontimeout=function(){a?n(a):i("timeout of "+t+"ms occured while fetching resource: "+e)},r.responseType="blob",r.timeout=t,r.open("GET",e,!0),r.send(),fe.impl.options.imagePlaceholder){var s=fe.impl.options.imagePlaceholder.split(/,/);s&&s[1]&&(a=s[1])}function i(e){console.error(e),n("")}})},uid:(e=0,function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+e++}),delay:function(e){return function(t){return new ue.a(function(n){setTimeout(function(){n(t)},e)})}},asArray:function(e){for(var t=[],n=e.length,a=0;a<n;a++)t.push(e[a]);return t},escapeXhtml:function(e){return e.replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(e){return new ue.a(function(t,n){var a=new Image;a.onload=function(){t(a)},a.onerror=n,a.src=e})},width:function(e){var t=n(e,"border-left-width"),a=n(e,"border-right-width");return e.scrollWidth+t+a},height:function(e){var t=n(e,"border-top-width"),a=n(e,"border-bottom-width");return e.scrollHeight+t+a}};var e;function t(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:""}function n(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace("px",""))}}(),he=function(){var e=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(e,r,s){return t(e)?ue.a.resolve(e).then(n).then(function(t){var n=ue.a.resolve(e);return t.forEach(function(e){n=n.then(function(t){return a(t,e,r,s)})}),n}):ue.a.resolve(e)},shouldProcess:t,impl:{readUrls:n,inline:a}};function t(t){return-1!==t.search(e)}function n(t){for(var n,a=[];null!==(n=e.exec(t));)a.push(n[1]);return a.filter(function(e){return!le.isDataUrl(e)})}function a(e,t,n,a){return ue.a.resolve(t).then(function(e){return n?le.resolveUrl(e,n):e}).then(a||le.getAndEncode).then(function(e){return le.dataAsUrl(e,le.mimeType(t))}).then(function(n){return e.replace(function(e){return new RegExp("(url\\(['\"]?)("+le.escape(e)+")(['\"]?\\))","g")}(t),"$1"+n+"$3")})}}(),pe=function(){return{resolveAll:function(){return e(document).then(function(e){return ue.a.all(e.map(function(e){return e.resolve()}))}).then(function(e){return e.join("\n")})},impl:{readAll:e}};function e(){return ue.a.resolve(le.asArray(document.styleSheets)).then(function(e){var t=[];return e.forEach(function(e){try{le.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(t){console.log("Error while reading CSS rules from "+e.href,t.toString())}}),t}).then(function(e){return e.filter(function(e){return e.type===CSSRule.FONT_FACE_RULE}).filter(function(e){return he.shouldProcess(e.style.getPropertyValue("src"))})}).then(function(t){return t.map(e)});function e(e){return{resolve:function(){var t=(e.parentStyleSheet||{}).href;return he.inlineAll(e.cssText,t)},src:function(){return e.style.getPropertyValue("src")}}}}}(),de=function(){return{inlineAll:function t(n){if(!(n instanceof Element))return ue.a.resolve(n);return function(e){var t=e.style.getPropertyValue("background");return t?he.inlineAll(t).then(function(t){e.style.setProperty("background",t,e.style.getPropertyPriority("background"))}).then(function(){return e}):ue.a.resolve(e)}(n).then(function(){return n instanceof HTMLImageElement?e(n).inline():ue.a.all(le.asArray(n.childNodes).map(function(e){return t(e)}))})},impl:{newImage:e}};function e(e){return{inline:function(t){return le.isDataUrl(e.src)?ue.a.resolve():ue.a.resolve(e.src).then(t||le.getAndEncode).then(function(t){return le.dataAsUrl(t,le.mimeType(e.src))}).then(function(t){return new ue.a(function(n,a){e.onload=n,e.onerror=a,e.src=t})})}}}}(),me={imagePlaceholder:void 0,cacheBust:!1};function fe(){}function ge(e,t){return function(e){void 0===e.imagePlaceholder?fe.impl.options.imagePlaceholder=me.imagePlaceholder:fe.impl.options.imagePlaceholder=e.imagePlaceholder;void 0===e.cacheBust?fe.impl.options.cacheBust=me.cacheBust:fe.impl.options.cacheBust=e.cacheBust}(t=t||{}),ue.a.resolve(e).then(function(e){return function(e,t,n){if(!n&&t&&!t(e))return ue.a.resolve();return ue.a.resolve(e).then(function(e){return e instanceof HTMLCanvasElement?le.makeImage(e.toDataURL()):e.cloneNode(!1)}).then(function(n){return function(e,t,n){var a=e.childNodes;return 0===a.length?ue.a.resolve(t):function(e,t,n){var a=ue.a.resolve();return t.forEach(function(t){a=a.then(function(){return ve(t,n)}).then(function(t){t&&e.appendChild(t)})}),a}(t,le.asArray(a),n).then(function(){return t})}(e,n,t)}).then(function(t){return function(e,t){return t instanceof Element?ue.a.resolve().then(function(){var n,a;n=window.getComputedStyle(e),a=t.style,n.cssText?a.cssText=n.cssText:function(e,t){le.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(n,a)}).then(function(){[":before",":after"].forEach(function(n){!function(n){var a=window.getComputedStyle(e,n),r=a.getPropertyValue("content");if(""!==r&&"none"!==r){var s=le.uid();t.className=t.className+" "+s;var i=document.createElement("style");i.appendChild(function(e,t,n){var a="."+e+":"+t,r=n.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(n):function(e){return le.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(n);return document.createTextNode(a+"{"+r+"}")}(s,n,a)),t.appendChild(i)}}(n)})}).then(function(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}).then(function(){t instanceof SVGElement&&(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t instanceof SVGRectElement&&["width","height"].forEach(function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)}))}).then(function(){return t}):t}(e,t)})}(e,t.filter,!0)}).then(be).then(we).then(function(e){t.bgcolor&&(e.style.backgroundColor=t.bgcolor);t.style&&oe()(t.style).forEach(function(n){e.style[n]=t.style[n]});return e}).then(function(t){return function(e,t,n){return ue.a.resolve(e).then(function(e){return e.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),(new XMLSerializer).serializeToString(e)}).then(le.escapeXhtml).then(function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+"</foreignObject>"}).then(function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+n+'">'+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})}(t,le.width(e),le.height(e))})}function ye(e,t){return ge(e,t).then(le.makeImage).then(le.delay(100)).then(function(n){var a=function(e){var n=document.createElement("canvas");if(n.width=t.width||le.width(e),n.height=t.height||le.height(e),t.bgcolor){var a=n.getContext("2d");a.fillStyle=t.bgcolor,a.fillRect(0,0,n.width,n.height)}return n}(e);return a.getContext("2d").drawImage(n,0,0,a.width,a.height),a})}function ve(e,t,n){if(!n&&t&&!t(e))return ue.a.resolve();return ue.a.resolve(e).then(a).then(function(n){return r(e,n,t)}).then(function(t){return s(e,t)});function a(e){return e instanceof HTMLCanvasElement?le.makeImage(e.toDataURL()):e.cloneNode(!1)}function r(e,t,n){var a=e.childNodes;return 0===a.length?ue.a.resolve(t):function(e,t,n){var a=ue.a.resolve();return t.forEach(function(t){a=a.then(function(){return ve(t,n)}).then(function(t){t&&e.appendChild(t)})}),a}(t,le.asArray(a),n).then(function(){return t});function r(e,t,n){var a=ue.a.resolve();return t.forEach(function(t){a=a.then(function(){return ve(t,n)}).then(function(t){t&&e.appendChild(t)})}),a}}function s(e,t){return t instanceof Element?ue.a.resolve().then(function(){!function(e,t){e.cssText?t.cssText=e.cssText:function(e,t){le.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}(e,t)}(window.getComputedStyle(e),t.style)}).then(function(){[":before",":after"].forEach(function(n){!function(n){var a=window.getComputedStyle(e,n),r=a.getPropertyValue("content");if(""===r||"none"===r)return;var s=le.uid();t.className=t.className+" "+s;var i=document.createElement("style");i.appendChild(function(e,t,n){var a="."+e+":"+t,r=n.cssText?function(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}(n):function(e){return le.asArray(e).map(function(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}).join("; ")+";"}(n);return document.createTextNode(a+"{"+r+"}")}(s,n,a)),t.appendChild(i)}(n)})}).then(function(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value);e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}).then(function(){if(!(t instanceof SVGElement))return;if(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),!(t instanceof SVGRectElement))return;["width","height"].forEach(function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)})}).then(function(){return t}):t;function n(){function n(e,t){if(e.cssText)t.cssText=e.cssText;else n(e,t);function n(e,t){le.asArray(e).forEach(function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))})}}n(window.getComputedStyle(e),t.style)}function a(){function n(n){var a=window.getComputedStyle(e,n),r=a.getPropertyValue("content");if(r===""||r==="none")return;var s=le.uid();t.className=t.className+" "+s;var i=document.createElement("style");function o(e,t,n){var a="."+e+":"+t,r=n.cssText?s(n):i(n);return document.createTextNode(a+"{"+r+"}");function s(e){var t=e.getPropertyValue("content");return e.cssText+" content: "+t+";"}function i(e){return le.asArray(e).map(t).join("; ")+";";function t(t){return t+": "+e.getPropertyValue(t)+(e.getPropertyPriority(t)?" !important":"")}}}i.appendChild(o(s,n,a)),t.appendChild(i)}[":before",":after"].forEach(function(e){n(e)})}function r(){if(e instanceof HTMLTextAreaElement)t.innerHTML=e.value;if(e instanceof HTMLInputElement)t.setAttribute("value",e.value)}function s(){if(!(t instanceof SVGElement))return;if(t.setAttribute("xmlns","http://www.w3.org/2000/svg"),!(t instanceof SVGRectElement))return;["width","height"].forEach(function(e){var n=t.getAttribute(e);if(!n)return;t.style.setProperty(e,n)})}}}function be(e){return pe.resolveAll().then(function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e})}function we(e){return de.inlineAll(e).then(function(){return e})}fe.toSvg=ge,fe.toPng=function(e,t){return ye(e,t||{}).then(function(e){return e.toDataURL()})},fe.toJpeg=function(e,t){return ye(e,t=t||{}).then(function(e){return e.toDataURL("image/jpeg",t.quality||1)})},fe.toBlob=function(e,t){return ye(e,t||{}).then(le.canvasToBlob)},fe.toPixelData=function(e,t){return ye(e,t||{}).then(function(t){return t.getContext("2d").getImageData(0,0,le.width(e),le.height(e)).data})},fe.impl={fontFaces:pe,images:de,util:le,inliner:he,options:{}};var Te,ke=fe,Se=(Te={root:null,width:1280,height:800,gridSide:80,curIndex:0,curId:"",sectionMode:"edit",menuType:"block",topLayerType:"",explorationInstance:null,homePageInstance:null,styleEditor:null,animeEditor:null,sections:[{id:20180526,components:[],sectionType:"normal",wareType:{type:-1,aType:25002},name:"自创题",courseWareTypeId:1,courseId:2,gradeId:1,wareObj:void 0}],wareClassObj:{wareSort:H,wareElement:J,wareConnect:se,wareBlank:ee},curALevel:0,selectedObject:{instance:null,type:0},counter:null,saveTime:0,init:function(e){this.root=e},getSection:function(e){return void 0===e&&(e=this.curIndex),this.sections[e]},checkSection:function(e){void 0===e&&(e=this.curIndex);var t=this.getSection(e);return!!t&&(0===t.components.length&&!t.wareObj)},getSectionEle:function(e){return void 0===e&&(e=this.curIndex),document.querySelectorAll(".exploration-container")[e]},showCounter:function(e,t){var n=this;if(this.counter)this.counter.isHide=!1,this.counter.isShowCount=!0;else{console.log("counter");var a="block-count";-1===G.a[a]?(G.a[a]=0,G.a.getImport(a).then(function(r){O.default.component(a,r.default),G.a[a]=1,n.counter=n.addBlockElement(void 0,a,!0),n.counter.setCall(e,t),n.counter.isHide=!1,n.counter.isShowCount=!0})):1===G.a[a]&&(this.counter=this.addBlockElement(void 0,"block-count",!0),this.counter.setCall(e,t),this.counter.isHide=!1,this.counter.isShowCount=!0)}},hideCounter:function(){this.counter&&this.counter.hideCounter()}},X()(Te,"checkSection",function(e){void 0===e&&(e=this.curIndex);var t=this.getSection(e);return!!t&&(0===t.components.length&&!t.wareObj)}),X()(Te,"setSubmitShow",function(e){this.explorationInstance&&this.explorationInstance.setSubmitShow(e)}),X()(Te,"checkApply",function(e){var t=this.getSection(e);return t.wareObj&&t.wareObj.checkApply?t.wareObj.checkApply():0}),X()(Te,"resetChangeApply",function(){this.homePageInstance&&this.homePageInstance.resetChangeApply()}),X()(Te,"submitExploration",function(){var e=-1,t=this.getSection();return t.wareObj&&t.wareObj.submit&&(e=t.wareObj.submit()),e}),X()(Te,"autoSubmit",function(){this.explorationInstance&&this.explorationInstance.submitExploration()}),X()(Te,"submitAnswerPicture",function(e){ke.toJpeg(this.getSectionEle(),{width:800,height:500,quality:.65}).then(function(t){e&&e(t)}).catch(function(e){console.error("oops, something went wrong!",e)})}),X()(Te,"deepCopy",function(e){return JSON.parse($()(e))}),X()(Te,"detachComponents",function(e){e.forEach(function(e){e.$el.remove()}),this.counter&&(this.counter.$el.remove(),this.counter=null)}),X()(Te,"attachComponents",function(e,t){t.forEach(function(t){e.append(t.$el)});var n=this.getSection();if(n.bgUrl){var a=n.bgUrl.endsWith("png")?"url("+n.bgUrl+")":n.bgUrl;e.style.background=a}}),X()(Te,"addSection",function(e){}),X()(Te,"releaseSection",function(e){void 0===e&&(e=this.curIndex);var t=null;t="object"!=(void 0===e?"undefined":Y()(e))?this.getSection(e):e,this.detachComponents(t.components),t.wareObj&&(t.wareObj.release(),t.wareObj=null),t.components.forEach(function(e){e.$root=null,e.$destroy()}),t.components=[],t.sectionType="normal"}),X()(Te,"moveSection",function(e,t){}),X()(Te,"deleteSection",function(e){}),X()(Te,"loadBlockDatasById",function(e,t){var n=this;this.root.dataService.getData(e,function(e){if(e.data){n.isAdmin&&(console.log("loadBlockDatasById() set adminData"),n.adminData=e);var a=JSON.parse(e.data);a.forEach(function(t){t.courseId=e.courseId,t.courseWareTypeId=e.CourseWareTypeId}),n.loadBlockDatas(a),t&&t()}else n.root.$message("不存在该题目，或已被删除")})}),X()(Te,"loadBlockDatasTest",function(e){var t=this,a=e.indexOf("-");if(a>-1){this.resetSections();var r=e.substring(0,a),s=e.substring(a+1);n.e(28).then(n.bind(null,"jiQm")).then(function(e){t.loadBlockDatas(e.default[r][s])}).catch(function(e){console.log(e)})}}),X()(Te,"loadBlockDatas",function(e){var t=this;this.sections.forEach(function(e){t.resetSection(e,"edit"),t.releaseSection(e)}),this.sections=[],e.forEach(function(n,a){var r={components:[],sectionType:n.sectionType,wareObj:void 0,wareType:{type:-1,aType:25002},name:"自创题",courseWareTypeId:1,courseId:2,gradeId:1};n.wareType&&(r.wareType=n.wareType),n.name&&(r.name=n.name),n.courseId&&(r.courseId=n.courseId),n.courseWareTypeId&&(r.courseWareTypeId=n.courseWareTypeId),n.gradeId&&(r.gradeId=n.gradeId),t.sections.splice(a,0,r),t.addWareObj(n.sectionType,a);var s=0,i=0,o={};n.components.forEach(function(e){e.name&&G.a[e.name]&&(o[e.name]||(o[e.name]=!0,s++))}),console.log("loadBlockDatas() "+s,o);var c=function(n){o.hasOwnProperty(n)&&(-1===G.a[n]?(G.a[n]=0,G.a.getImport(n).then(function(a){O.default.component(n,a.default),G.a[n]=1,++i===s&&t._loadBlockDatas(e)}).catch(function(e){console.log("loadBlockDatas() import error::",n)})):1===G.a[n]&&++i===s&&t._loadBlockDatas(e))};for(var u in o)c(u)})}),X()(Te,"_loadBlockDatas",function(e){var t=this;setTimeout(function(){t.resetCanvasBG(),e.forEach(function(e,n){var a=t.getSectionEle(n),r="";e.bgUrl&&(r=e.bgUrl.endsWith("png")?"url("+e.bgUrl+")":e.bgUrl,t.getSection(n).bgUrl=e.bgUrl),a.style.background=r,e.components.forEach(function(e){t.loadBlockData(e,n)})}),t.resetSections()},0)}),X()(Te,"loadBlockData",function(e,t){if(e.name){var n=this.addBlockElement(t,e.name);return n&&(n.setParams&&n.setParams(e),this.bindWareObj(n,t)),n}console.log("loadBlockData() missing the params.name",e)}),X()(Te,"saveImageBase64",function(e){var t=this;console.log("saveImageBase64()");var n=[],a=[];if(this.sections.forEach(function(e){e.screenshot&&(n.push({picbase64:e.screenshot.substring(e.screenshot.indexOf("base64")+7)}),a.push(e)),e.components.forEach(function(e){if(e.params&&"block-image"===e.params.type&&""===e.params.imgUrl){var t={picbase64:e.imgData.substring(e.imgData.indexOf("base64")+7)},r=n.findIndex(function(e){return t.picbase64===e.picbase64});e.imgRepeatIndex=-1,r>-1?e.imgRepeatIndex=r:n.push(t),a.push(e)}})}),0===n.length)return console.log("saveImageBase64() direct to saveBlockElements"),void this.saveBlockElements(e);this.root.dataService.saveImages(n,function(n){a.forEach(function(e,t){e.params?e.imgRepeatIndex>-1?e.params.imgUrl=n[e.imgRepeatIndex].pictureUrl:e.params.imgUrl=n[t].pictureUrl:e.imgUrl=n[t].pictureUrl}),console.log(n),t.saveBlockElements(e)})}),X()(Te,"saveExploration",function(e){console.log("saveExploration()");var t=(new Date).getTime();t-this.saveTime<3e3?this.root.$message("请不要连续保存题目"):(this.saveTime=t,this.saveSectionImage(void 0,e))}),X()(Te,"saveSectionImage",function(e,t){var n=this;e||(e=this.getSectionEle()),setTimeout(function(){ke.toPng(e,{width:800,height:500}).then(function(e){n.getSection().screenshot=e,n.saveImageBase64(t)}).catch(function(e){console.error("oops, something went wrong!",e)})},0)}),X()(Te,"saveBlockElements",function(e){var t=this;console.log("saveBlockElements()");var n=[];this.sections.forEach(function(a,r){if(a.wareObj&&a.wareObj.resetParams&&a.wareObj.resetParams(),n[r]={components:[],sectionType:a.sectionType,wareType:a.wareType,name:a.name,gradeId:a.gradeId},a.bgUrl&&(n[r].bgUrl=a.bgUrl),a.components.forEach(function(e,t){!e.isIncluded&&e.params&&(n[r].components[t]=e.params)}),t.isAdmin)!t.adminData||0!==t.adminData.teacherId&&"0"!==t.adminData.teacherId||(t.root.dataService.teacherId=t.adminData.teacherId,t.root.dataService.updatedTemplate(!0,t.adminData.saveId,t.adminData.name,a.imgUrl,t.adminData.course.courseId,t.adminData.courseWareType.typeId,t.adminData.courseType,t.adminData.courseAtype,t.adminData.gradeId?t.adminData.gradeId:1,n));else if(t.explorationInstance&&t.explorationInstance.quickWare){var s=t.explorationInstance.getQuickWareObj();t.root.dataService.saveCustomCourseWare(s.name,a.imgUrl,a.courseId,s.typeId,a.wareType.type,a.wareType.aType,a.gradeId,n)}else t.root.dataService.saveCustomCourseWare(a.name,a.imgUrl,a.courseId,a.courseWareTypeId,a.wareType.type,a.wareType.aType,a.gradeId,n,e)})}),X()(Te,"setAdmin",function(e){this.isAdmin=e,!this.isAdmin&&this.adminData&&(this.adminData=null)}),X()(Te,"setSelectedObject",function(e){null===e?(this.selectedObject.instance=null,this.selectedObject.type=0):(this.selectedObject.instance&&this.selectedObject.instance!==e.instance&&("block-text"===this.selectedObject.instance.params.type&&this.selectedObject.instance.isEditing&&this.selectedObject.instance.setIsEditing(),this.selectedObject.instance.releaseDdmrr&&this.selectedObject.instance.releaseDdmrr()),this.selectedObject.instance=e.instance,this.selectedObject.type=e.type,"anime"!==this.menuType&&(this.menuType="style"),this.styleEditor&&this.styleEditor.setInstance(this.selectedObject.instance),this.animeEditor&&this.animeEditor.setInstance(this.selectedObject.instance))}),X()(Te,"setStyleEditor",function(e){this.styleEditor=e,this.styleEditor&&this.styleEditor.setInstance(this.selectedObject.instance)}),X()(Te,"setAnimeEditor",function(e){this.animeEditor=e,this.animeEditor&&this.animeEditor.setInstance(this.selectedObject.instance)}),X()(Te,"newVueElement",function(e,t){if(!e||!t)return null;var n=O.default.component(e),a=void 0;return n?((a=new n).$root=this.root,a.$mount(t)):(a=null,console.log("EditorManager::newVueElement() elementLabel:"+e+" is undefined.")),a}),X()(Te,"addBlockElement",function(e,t,n){e||(e=this.curIndex),t||(t="block-element");var a=document.createElement("DIV");this.getSectionEle(e).appendChild(a);var r=this.newVueElement(t,a);!n&&r&&this.getSection(e).components.push(r);return r}),X()(Te,"addBlockText",function(e){var t=this.addBlockElement(e);return t.setParams({type:"block-text",width:200,height:50,html:"这里是文本",fontSize:20,textAlign:"center"}),t}),X()(Te,"addBlockImage",function(e,t){var n=this.addBlockElement(t);return n.setParams({type:"block-image"}),this.setBlockImage(n,e),n}),X()(Te,"addBlockSvg",function(e,t){var n=this.addBlockElement(t),a={type:"block-svg",html:e,fill:"transparent"};return n.setParams(a),n}),X()(Te,"addBlockIframe",function(e,t){var n=this.addBlockElement(e),a={type:"block-iframe",src:t};return n.setParams(a),n}),X()(Te,"bindWareObj",function(e,t){var n=this.getSection(t);n.wareObj&&n.wareObj.addInstance(e)}),X()(Te,"setBlockImage",function(e,t){"block-image"===e.params.type&&(console.log("setBlockImage()"),t instanceof File?(e.setParam("opacity",0),this.fileToImgBase64(t,0,function(t,n,a){for(;n>1e3||a>1e3;)n*=.8,a*=.8;for(;n<10||a<10;)n*=1.2,a*=1.2;e.setParams({width:n,height:a,opacity:1,src:t})})):e.setParam("src",t))}),X()(Te,"fileToImgBase64",function(e,t,n){var a=new FileReader;a.onload=function(){var e=a.result,t=new Image;t.src=e,t.onload=function(){n&&n(e,t.width,t.height)}},a.readAsDataURL(e)}),X()(Te,"addWareObj",function(e,t){if("normal"===e)return!1;void 0===t&&(t=this.curIndex);var n=this.getSection(t);if(console.log("addWareObj() "+e+"  "+t),n.wareObj)return this.root.$message.warning("已经存在题本"),!1;n.components.length>0&&this.releaseSection(t),n.components=[],n.sectionType=e;var a=e.split("-"),r=this.wareClassObj[a[0]];return r&&(n.wareObj=new r(this.root,a[1])),!0}),X()(Te,"resetCanvasBG",function(){var e=this;setTimeout(function(){for(var t=document.getElementsByClassName("edit-canvas"),n=0;n<t.length;n++){var a=t[n].getContext("2d");if(a.strokeStyle="gray",a.clearRect(0,0,e.width,e.height),"edit"===e.sectionMode){var r=e.width/e.gridSide,s=e.height/e.gridSide;a.beginPath(),a.lineWidth=1;for(var i=1;i<r;i++)a.moveTo(i*e.gridSide,0),a.lineTo(i*e.gridSide,e.height);for(var o=1;o<s;o++)a.moveTo(0,o*e.gridSide),a.lineTo(e.width,o*e.gridSide);a.closePath(),a.stroke(),a.beginPath(),a.lineWidth=2,a.moveTo(1,1),a.lineTo(e.width-1,1),a.lineTo(e.width-1,e.height-1),a.lineTo(1,e.height-1),a.closePath(),a.stroke()}}},0)}),X()(Te,"alignCanvas",function(e){var t=this;setTimeout(function(){var n=document.getElementsByTagName("canvas")[0];if(n){var a=n.getContext("2d");a.strokeStyle="red",a.lineWidth=1,a.beginPath(),e.forEach(function(e,n,r){"x"===e.type?(a.moveTo(e.value,0),a.lineTo(e.value,t.height)):"y"===e.type&&(a.moveTo(0,e.value),a.lineTo(t.width,e.value))}),a.closePath(),a.stroke(),0===e.length&&t.resetCanvasBG()}},0)}),X()(Te,"delete",function(){var e=this;if(this.selectedObject){if(this.selectedObject.instance.parentInstance)return this.selectedObject.instance.parentInstance.removeChild(this.selectedObject.instance.childIndex),this.menuType="block",void this.setSelectedObject(null);var t=this.getSection(),n=t.components.findIndex(function(t){return t===e.selectedObject.instance});if(n>-1){this.menuType="block",this.setSelectedObject(null);var a=t.components[n],r=!1;t.wareObj?(r=t.wareObj.removeInstance(a))&&1===t.components.length&&(this.root.$message("删除"+t.sectionType+"成功"),t.sectionType="normal",t.wareObj.release(),t.wareObj=void 0):r=!0,console.log("delete() "+r),(r||void 0===r)&&(a.deleteSelf(),t.components[n]=null,t.components.splice(n,1))}}}),X()(Te,"resetSections",function(e){var t=this;void 0===e&&(e=this.sectionMode),console.log("resetSections() "+e),this.selectedObject.instance&&(this.onCurrentSectionClick(),this.selectedObject.instance&&this.onCurrentSectionClick()),this.sections.forEach(function(n){t.resetSection(n,e),t.initCurrentSectionAnime(n)})}),X()(Te,"resetSection",function(e,t){e.wareObj&&e.wareObj.setSectionMode&&e.wareObj.setSectionMode(t),e.components.forEach(function(e){e.setSectionMode&&e.setSectionMode(t),"display"===t&&(e.isEditing&&e.setIsEditing(!1),e.isSelected&&(console.log("selected"),e.setIsSelected(!1)))})}),X()(Te,"initCurrentSectionAnime",function(e){var t=this;this.curALevel=0,console.log("initCurrentSectionAnime()");("object"!=(void 0===e?"undefined":Y()(e))?this.getSection(e):e).components.forEach(function(e){t.resetElementAnime(e)}),"display"===this.sectionMode&&setTimeout(function(){t.playNextAnime()},250)}),X()(Te,"resetElementAnime",function(e){var t=e.params.aAnime;t&&("edit"===this.sectionMode?0===e.params.aStep&&(t.transX&&t.transX.duration>0&&(e.params.transX+=500),t.rotate&&t.rotate.duration>0&&(e.params.rotate+=360),t.opacity&&t.opacity.duration>0&&(e.params.opacity=1),t.scale&&t.scale.duration>0&&(e.params.scale=1)):(e.params.aStep=0,t.transX&&t.transX.duration>0&&(e.params.transX-=500),t.rotate&&t.rotate.duration>0&&(e.params.rotate-=360),t.opacity&&t.opacity.duration>0&&(e.params.opacity=0),t.scale&&t.scale.duration>0&&(e.params.scale=0)))}),X()(Te,"playNextAnime",function(e){var t=this;console.log("playNextAnime() "+this.curALevel),this.getSection(e).components.forEach(function(e){var n=e.params.aAnime;if(n&&e.params.aLevel===""+t.curALevel){if(0!==e.params.aStep)return;var a={};e.params.aStep=1,n.transX&&n.transX.duration>0?a.translateX={value:"+=500",duration:n.transX.duration,delay:n.transX.delay?n.transX.delay:0,easing:"linear"}:a.translateX=[e.params.transX,e.params.transX],a.translateY=[e.params.transY,e.params.transY],n.rotate&&n.rotate.duration>0&&(a.rotate={value:"+=360",duration:n.rotate.duration,delay:n.rotate.delay?n.rotate.delay:0,easing:"linear"}),n.opacity&&n.opacity.duration>0&&(a.opacity={value:[0,1],duration:n.opacity.duration,delay:n.opacity.delay?n.rotate.delay:0}),n.scale&&n.scale.duration>0&&(a.scale={value:[0,1],duration:n.scale.duration,delay:n.scale.delay?n.scale.delay:0}),a.targets=e.$el,a.easing="linear",a.complete=function(t){var n=e.params.aAnime;n.transX&&n.transX.duration>0&&(e.params.transX+=500),n.rotate&&n.rotate.duration>0&&(e.params.rotate+=360),n.opacity&&n.opacity.duration>0&&(e.params.opacity=1),n.scale&&n.scale.duration>0&&(e.params.scale=1),e.params.aStep=2};anime(a)}}),this.curALevel++}),X()(Te,"onCurrentSectionClick",function(e){if("edit"===this.sectionMode){if(this.topLayerType)return void(this.topLayerType="");if(this.selectedObject.instance){if(0!==this.selectedObject.type)return"block-text"===this.selectedObject.instance.params.type&&this.selectedObject.instance.isEditing&&this.selectedObject.instance.setIsEditing(),this.selectedObject.instance.setIsSelected(!0),void(this.menuType="style");this.selectedObject.instance.setIsSelected(!1),this.menuType="block"}"block"!==this.menuType&&(this.menuType="block")}else"display"===this.sectionMode&&(this.selectedObject.instance&&this.selectedObject.instance.setIsSelected(!1),this.menuType="block",e||this.playNextAnime())}),X()(Te,"sendOptions",function(e,t){if(this.selectedObject)switch(console.log("sendOptions()"+this.selectedObject.instance.params.type),e){case"fontSize":this.selectedObject.instance.addFontSize(t?1:-1);break;case"color":this.selectedObject.instance.setColor(t);break;case"border":this.selectedObject.instance.setBorder(t);break;case"borderWidth":this.selectedObject.instance.setBorderWidth(t);break;case"borderColor":this.selectedObject.instance.setBorderColor(t);break;case"backgroundColor":this.selectedObject.instance.setBackgroundColor(t);break;case"depth":this.selectedObject.instance.addDepth(t);break;case"delete":this.delete()}}),X()(Te,"release",function(){this.root=null}),Te),Ie="https://courseware-api.ebag.readboy.com",Oe="https://beike-api.ebag.readboy.com",Ee={root:null,teacherId:"",token:"",periodId:"",moment:"",termFlag:"",init:function(e){this.root=e},initParams:function(){return this.teacherId=sessionStorage.getItem("teacherId"),this.token=sessionStorage.getItem("accessToken"),this.token&&this.teacherId?"true"===sessionStorage.getItem("isTeacher")||(this.root.$message("登录身份不是教师，请从互动软件中打开此页面"),!1):(this.root.$message.error("参数丢失，请从互动软件中打开此页面"),!1)},checkResponse:function(e){if(!e||!e.body)return this.root.$message("返回数据错误"),!1;if(1e4===e.body.F_responseNo)return!0;var t=void 0;return 12105===e.body.F_responseNo?t="未登录，请从互动课堂中打开此页面":(t=e.body.F_responseMsg)||(t="参数错误，请从互动课堂中打开此页面"),this.root.$message(t),!1},getCourses:function(e){var t=this,n=Ie+"/v1/courseware/courses";this.root.$http.get(n).then(function(n){t.checkResponse(n)&&e&&e(n.body.F_data)},function(e){console.log("load error")})},getTypes:function(e,t){var n=this,a=Ie+"/v1/courseware/types";this.root.$http.get(a,{params:{F_course_id:e}}).then(function(e){n.checkResponse(e)&&t&&t(e.body.F_data)},function(e){console.log("load error")})},getList:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,r=this,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments[5],o=Ie+"/v1/courseware/list";this.root.$http.get(o,{params:{F_teacher_id:e,F_course_id:t,F_courseware_type:n,F_grade_id:-1,F_limit:a,F_page:s}}).then(function(e){r.checkResponse(e)&&i&&i(e.body)},function(e){console.log("load error")})},saveImages:function(e,t){var n=this,a=Ie+"/v1/editor/pic-save";this.root.$http.post(a,$()(e),{params:{F_teacher_id:sessionStorage.getItem("teacherId"),F_accesstoken:sessionStorage.getItem("accessToken")}}).then(function(e){n.checkResponse(e)&&t&&t(e.body.F_data)},function(e){console.log(e),console.log("image save error")})},saveCustomCourseWare:function(e,t,n,a,r,s,i,o,c){var u=this,l=Ie+"/v1/courseware/save";this.root.$http.post(l,$()(o),{params:{F_teacher_id:sessionStorage.getItem("teacherId"),F_accesstoken:sessionStorage.getItem("accessToken"),F_name:e,F_cover_url:t,F_course_id:n,F_courseware_type:a,F_course_type:r,F_course_atype:s,F_grade_id:i}}).then(function(e){u.checkResponse(e)&&(u.root.$message("保存成功"),c&&c(e.body))},function(e){console.log("save error",e)})},getData:function(e,t){var n=this,a=Ie+"/v1/courseware/get";this.root.$http.get(a,{params:{F_teacher_id:sessionStorage.getItem("teacherId"),F_accesstoken:sessionStorage.getItem("accessToken"),F_save_id:e}}).then(function(e){n.checkResponse(e)&&t&&t(e.body.F_data)},function(e){n.root.$message("加载题目数据出错")})},deleteCourseWare:function(e){var t=this,n=Ie+"/v1/courseware/delete";return this.root.$http.get(n,{params:{F_teacher_id:sessionStorage.getItem("teacherId"),F_accesstoken:sessionStorage.getItem("accessToken"),F_save_id:e}}).then(function(e){t.checkResponse(e)&&t.root.$message("删除课件成功")},function(e){console.log("delete error")})},insertCourseWare:function(e){var t=this,n=Ie+"/v1/courseware/insert";return this.root.$http.get(n,{params:{F_teacher_id:"0",F_accesstoken:sessionStorage.getItem("accessToken"),F_save_id:e}}).then(function(e){t.checkResponse(e)&&t.root.$message("插入课件成功")},function(e){console.log("insert error")})},updatedTemplate:function(e,t,n,a,r,s,i,o,c,u){var l=this,h=Ie+"/v1/courseware/update";this.root.$http.post(h,$()(u),{params:{F_teacher_id:e?"0":sessionStorage.getItem("teacherId"),F_accesstoken:sessionStorage.getItem("accessToken"),F_save_id:t,F_name:n,F_cover_url:a,F_course_id:r,F_courseware_type:s,F_course_type:i,F_course_atype:o,F_grade_id:c}}).then(function(e){console.log(e.body),l.checkResponse(e)&&l.root.$message("更新自定义模板成功")},function(e){console.log("updated template error")})},referenceResources:function(e,t,n){var a=this,r=Ie+"/v1/courseware/reference";return this.root.$http.post(r,{F_resource_id:e,F_teacher_id:sessionStorage.getItem("teacherId"),F_accesstoken:sessionStorage.getItem("accessToken"),F_period_id:sessionStorage.getItem("periodId"),F_moment:sessionStorage.getItem("moment"),F_term_flag:sessionStorage.getItem("termFlag")},{emulateJSON:!0}).then(function(e){a.checkResponse(e)&&t&&t()},function(e){console.log("reference resource error")})},courseWareInfo:function(e,t){var n=this,a=Ie+"/v1/courseware/info";this.root.$http.get(a,{params:{F_resource_id:e,F_accesstoken:sessionStorage.getItem("accessToken")}}).then(function(e){n.checkResponse(e)&&t&&t(e.body)},function(e){console.log(e)})},getCourseWareList:function(e){var t=this,n=Oe+"/v1/period/coursewareList";this.root.$http.get(n,{params:{F_teacher_id:sessionStorage.getItem("teacherId"),F_accesstoken:sessionStorage.getItem("accessToken"),F_period_id:sessionStorage.getItem("periodId"),F_moment:sessionStorage.getItem("moment"),F_term_flag:sessionStorage.getItem("termFlag")}}).then(function(n){t.checkResponse(n)&&e(n.body.F_list)},function(e){console.log("get coursewareList error")})},deleteResource:function(e,t){var n=this,a=Oe+"/v1/period/deleteResource";return this.root.$http.get(a,{params:{F_teacher_id:sessionStorage.getItem("teacherId"),F_accesstoken:sessionStorage.getItem("accessToken"),F_period_id:sessionStorage.getItem("periodId"),F_moment:sessionStorage.getItem("moment"),F_term_flag:sessionStorage.getItem("termFlag"),F_resource_ids:e}}).then(function(e){n.checkResponse(e)&&t&&t()},function(e){console.log("delete resource error")})},release:function(){this.root=null}};O.default.use(P.a),O.default.http.interceptors.push(function(e,t){(e.url.endsWith("pic-save")||e.url.endsWith("save")||e.url.endsWith("update"))&&e.headers.set("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")}),O.default.component(I.a.name,I.a),O.default.component(k.a.name,k.a),O.default.component(w.a.name,w.a),O.default.component(v.a.name,v.a),O.default.component(g.a.name,g.a),O.default.component(m.a.name,m.a),O.default.component(p.a.name,p.a),O.default.component(l.a.name,l.a),O.default.component(c.a.name,c.a),O.default.prototype.$confirm=i.a,O.default.prototype.$message=r.a,O.default.directive("dybtn",{inserted:function(e,t){var n=e,a=t.value;if(a){if(a.srcDown){var r=a.srcDown;n.onmousedown=function(e){n.setAttribute("src",r)}}if(a.srcUp){var s=a.srcUp;n.setAttribute("src",s),n.onmouseup=function(e){n.setAttribute("src",s)}}a.unDrag&&(n.ondragstart=function(e){return!1})}}}),O.default.config.productionTip=!1,window.iex=new O.default({el:"#app",router:M,components:{App:j},template:"<App/>",data:{editorManager:Se,dataService:Ee,ddmrrScale:1,isTeacher:!1},methods:{getIsTeacher:function(){return"true"===sessionStorage.getItem("isTeacher")?this.isTeacher=!0:this.isTeacher=!1,this.isTeacher}},created:function(){console.log("Vue::created()"),this.editorManager.init(this),this.dataService.init(this)},mounted:function(){console.log("Vue::mounted()")},beforeDestroy:function(){this.editorManager.release(),this.dataService.release()}})},NOFV:function(e,t){},Q6SQ:function(e,t){},R3KO:function(e,t,n){"use strict";var a=function(e,t){var n=void 0,a=void 0,r=void 0,s=void 0,i=void 0,o=void 0;if(e.params.transX>=t.params.transX){n=0,i=e.params.transX-t.params.transX;var c=e.params.width+e.params.transX,u=t.params.width+t.params.transX;r=u>=c?e.params.width:e.params.width-(c-u)}if(e.params.transX<t.params.transX){n=t.params.transX-e.params.transX,i=0;var l=e.params.width+e.params.transX;r=t.params.width+t.params.transX>=l?l-t.params.transX:t.params.width}if(e.params.transY>=t.params.transY){a=0,o=e.params.transY-t.params.transY;var h=e.params.height+e.params.transY,p=t.params.height+t.params.transY;s=p>=h?e.params.height:e.params.height-(h-p)}if(e.params.transY<t.params.transY){a=t.params.transY-e.params.transY,o=0;var d=e.params.height+e.params.transY;s=t.params.height+t.params.transY>=d?d-t.params.transY:t.params.height}var m=t.$refs.ddmrrDom.querySelector("img");e.$refs.ddmrrDom.querySelector("canvas").getContext("2d").drawImage(m,i+0,o-2,r,s,n,a,r,s)},r=n("JZJL"),s=n("W3Iv"),i=n.n(s),o=n("BO1k"),c=n.n(o),u=n("d7EF"),l=n.n(u),h=n("pFYg"),p=n.n(h),d=n("Zrlr"),m=n.n(d),f=n("wxAW"),g=n.n(f),y=window.document,v=function e(t){return this.appendChild(t),e.bind(this)},b=function(){function e(t){m()(this,e),this.tag=t,this.element=y.createElement(t),this.element.style.position="absolute",this.element.append=v}return g()(e,null,[{key:"create",value:function(t){return new e(t)}}]),g()(e,[{key:"child",value:function(e){return this.element.appendChild(e.init()),this}},{key:"position",value:function(e){switch(void 0===e?"undefined":p()(e)){case"string":var t=/\s*(\d+)\s+?(\d+)\s+?(\d+)\s+?(\d+)/.exec(e);if(!t)throw new Error("arguments should be `1 2 3 4` or four number");this.element.style.top=t[1]+"px",this.element.style.right=t[2]+"px",this.element.style.bottom=t[3]+"px",this.element.style.left=t[4]+"px";break;default:this.element.style.top=e[0]+"px",this.element.style.right=e[1]+"px",this.element.style.bottom=e[2]+"px",this.element.style.left=e[3]+"px"}return this}},{key:"id",value:function(e){return this.element.id=e,this}},{key:"type",value:function(e){return this.element.type=e,this}},{key:"style",value:function(e){var t=!0,n=!1,a=void 0;try{for(var r,s=c()(i()(e));!(t=(r=s.next()).done);t=!0){var o=r.value,u=l()(o,2),h=u[0],p=u[1];this.element.style[h]=p}}catch(e){n=!0,a=e}finally{try{!t&&s.return&&s.return()}finally{if(n)throw a}}return this}},{key:"border",value:function(e,t){return this.element.style.border=e,this.element.style.borderRadius=t+"px",this}},{key:"text",value:function(e){return this.element.innerText=e,this}},{key:"bgColor",value:function(e){return this.element.style.backgroundColor=e,this}},{key:"width",value:function(e){return this.element.style.width=e+"px",this}},{key:"height",value:function(e){return this.element.style.height=e+"px",this}},{key:"readonly",value:function(){return this.element.readOnly=!0,this}},{key:"color",value:function(e){return this.element.style.color=e,this}},{key:"fontSize",value:function(e){return this.element.style.fontSize=e+"px",this}},{key:"zIndex",value:function(e){return this.element.style.zIndex=e,this}},{key:"mid",value:function(){return this.position("0 0 0 0").style({margin:"auto"})}},{key:"load",value:function(e,t){return this.element.src=e,this.element.onload=function(){},this}},{key:"copy",value:function(){}},{key:"init",value:function(){return this.element}}]),e}(),w=function(){return b.create("input").type("text").readonly().width(147).height(73).fontSize(44).color("#595959").style({"text-align":"center"}).border("3px solid #bfbfbf",6)},T=function(){return b.create("span").fontSize(48)},k=function(){return b.create("img")};n.d(t,"a",function(){return $});var S=!1,I=new Image;I.src="./static/images/pigeon/pigeon.png",I.onload=function(){this.isReady=!0};var O,E,x,C,j,A,_,M,P,F,X,D,Y=(E=b.create("div").id("pigeonformShadowBg").width(1280).height(800).bgColor("#f5f5f559").mid().zIndex(80).init(),x=b.create("div").id("pigeonformBg").border("3px solid grey",4).bgColor("whitesmoke").width(681).height(475).mid().init(),C=b.create("div").width(260).height(100).fontSize(28).color("#262626").text("鸽子鸽笼的数量限定").position([-254,0,0,0]).style({margin:"auto"}).init(),j=b.create("img").id("setPigeon").load("./static/images/pigeon/setpigeon.png").position([-100,0,0,-244]).style({margin:"auto"}).init(),A=w().id("pigeontextnumber").position([-100,-132,0,0]).style({margin:"auto"}).init(),_=T().text("只").position("317 0 0 800").init(),M=b.create("img").id("pigeonform").load("./static/images/pigeon/setbirdcage.png").position([166,0,0,-244]).style({margin:"auto"}).init(),P=w().id("birdercagetextnumber").position([166,-132,0,0]).style({margin:"auto"}).init(),F=T().text("个").position("448 0 0 800").init(),X=k().load("./static/images/pigeon/sure.png").id("pigeonsure").position([374,243,0,0]).style({margin:"auto"}).init(),D=k().load("./static/images/pigeon/cancel.png").id("pigeoncancel").position([374,-224,0,0]).style({margin:"auto"}).init(),(O=E,function(e){return O.append(e)})(x)(C)(j)(A)(_)(M)(P)(F)(X)(D),E),B=function(e){return document.querySelector("#"+e)},$={afterDrag:function(e,t){e.params.id&&e.params.id.startsWith("pigeon")&&$.whenMount(e,function(){e.inCage=!0,e.__targetArea=t,a(e,t)})},afterDragFail:function(e,t){e.params.id&&e.params.id.startsWith("pigeon")&&(e.inCage&&(e.inCage=!1),$.whenMount(e))},whenMount:function(e,t){var n=this;if(!S){S=!0;var a=document.querySelector(".edit-container .exploration-container");Y.style.display="none",a.appendChild(Y)}if(e.$root.isTeacher||e.$root.editorManager.setSubmitShow(!0),"pigeonbutton"==e.params.id){var s=e.$el.querySelector("img");e.$root.isTeacher?s.style.display="":s.style.display="none";var i=[B("birdercagetextnumber"),B("pigeontextnumber"),B("pigeonsure"),B("pigeoncancel")],o=i[0],c=i[1],u=i[2],l=i[3];o.onclick=function(){e.$root.editorManager.showCounter(function(t){return n.afterGetNumber(e,t)}),window.focusingelement=o},c.onclick=function(){e.$root.editorManager.showCounter(function(t){return n.afterGetNumber(e,t)}),window.focusingelement=c},function(e,t){function n(e,t,n){return function(){this.value>n?this.value=n:this.value<t&&0!=this.value&&(this.value=t),(isNaN(this.value)||0==this.value)&&(this.value=e)}}e.onblur=n(3,2,5),t.onblur=n(6,2,6)}(o,c);var h=e.wareObj.areas.reduce(function(e,t){return t.params.id&&t.params.id.startsWith("birdcage")&&e.push(t),e},[]),p=e.wareObj.moveingObjs.reduce(function(e,t){return t.params.id&&t.params.id.startsWith("pigeon")&&e.push(t),e},[]);Object(r.a)(p,h,e,I)(5,3);var d=e.wareObj.areas.find(function(e){return!!e.params.id&&"titleofpigeon"==e.params.id}).$refs.ddmrrDom.querySelector("#pigeonnumber");d.rightValue=2,d.onclick=function(){e.$root.editorManager.showCounter(function(t){return n.afterGetNumber(e,t)}),window.focusingelement=d};!function(e,t,n,a,r){n.onclick=function(){0!=t.value&&0!=e.value||(t.value=5,e.value=3),parseInt(t.value,10)<parseInt(e.value,10)&&(t.value=parseInt(e.value,10)+1);var n=r();parseInt(t.value,10)%parseInt(e.value,10)!=0?n.rightValue=parseInt(t.value,10)/parseInt(e.value,10)+1:n.rightValue=parseInt(t.value,10)/parseInt(e.value,10),console.log(parseInt(t.value,10),parseInt(e.value,10)),a(parseInt(t.value,10),parseInt(e.value,10)),n.previousElementSibling.innerText="有"+t.value+"个鸽子飞进"+e.value+"个笼子,总有一个鸽笼飞进了"}}(o,c,u,Object(r.a)(p,h,e,I),function(){return Y.style.display="none",d}),s.onclick=function(){Y.style.display=""},l.onclick=function(){Y.style.display="none"}}$.updateCanvas(e,t)},updateCanvas:function(e,t){if(e.$refs&&e.$refs.ddmrrDom){if(!e.$refs.ddmrrDom.querySelector("canvas")||!I.isReady)return setTimeout(function(){return $.updateCanvas(e,t)},0);var n=e.$refs.ddmrrDom.querySelector("canvas").getContext("2d");n.clearRect(0,0,I.width,I.height),n.drawImage(I,0,0,I.width,I.height),t&&t()}},whenMoving:function(e){var t=e.params;t.id&&t.id.startsWith("pigeon")&&e.inCage&&$.whenMount(e,function(){a(e,e.__targetArea)})},afterGetNumber:function(e,t){var n=window.focusingelement;return"clear"==t?a():"confirm"==t?(e.$root.editorManager.hideCounter(),a()):""==t?(n.value=0,a()):"0"==t?a():(n.value=t,a());function a(){n.focus(),setTimeout(function(){document.body.focus()},0)}},whenDestoryed:function(e){S=!1}}},Rh7U:function(e,t){},Yq4J:function(e,t){},ZzA9:function(e,t){},cqt9:function(e,t){},cwe7:function(e,t){},d7TW:function(e,t){},jZDA:function(e,t){},oq7i:function(e,t){},s1Q5:function(e,t,n){"use strict";var a={"classic-chase":-1,_getclassicchase:function(){return n.e(20).then(n.bind(null,"NOqM"))},"classic-cross-river":-1,_getclassiccrossriver:function(){return n.e(15).then(n.bind(null,"Di3d"))},"classic-navigation":-1,_getclassicnavigation:function(){return n.e(21).then(n.bind(null,"TJfZ"))},"block-abacus":-1,_getblockabacus:function(){return n.e(10).then(n.bind(null,"CXxh"))},"block-calculating":-1,_getblockcalculating:function(){return n.e(11).then(n.bind(null,"pAYH"))},"block-clocking":-1,_getblockclocking:function(){return n.e(4).then(n.bind(null,"kQPJ"))},"block-count":-1,_getblockcount:function(){return n.e(22).then(n.bind(null,"E6pk"))},"block-drainage":-1,_getblockdrainage:function(){return n.e(18).then(n.bind(null,"aPgt"))},"block-element":-1,_getblockelement:function(){return n.e(27).then(n.bind(null,"tfup"))},"block-equation":-1,_getblockequation:function(){return n.e(5).then(n.bind(null,"TPO3"))},"block-geometricCutting":-1,_getblockgeometricCutting:function(){return n.e(2).then(n.bind(null,"3roO"))},"block-mindmap":-1,_getblockmindmap:function(){return n.e(16).then(n.bind(null,"vBbu"))},"block-planting":-1,_getblockplanting:function(){return n.e(8).then(n.bind(null,"CbiZ"))},"block-quadrangle":-1,_getblockquadrangle:function(){return n.e(23).then(n.bind(null,"OmWL"))},"block-symmetry":-1,_getblocksymmetry:function(){return Promise.all([n.e(7),n.e(0)]).then(n.bind(null,"Ro/s"))},"block-tangram":-1,_getblocktangram:function(){return n.e(25).then(n.bind(null,"6LX7"))},"block-trainBridge":-1,_getblocktrainBridge:function(){return n.e(12).then(n.bind(null,"WCBm"))},"block-trainTruck":-1,_getblocktrainTruck:function(){return n.e(9).then(n.bind(null,"4Ayw"))},"block-transfer":-1,_getblocktransfer:function(){return Promise.all([n.e(13),n.e(0)]).then(n.bind(null,"cCLx"))},"block-waterInjection":-1,_getblockwaterInjection:function(){return n.e(14).then(n.bind(null,"I/We"))},"block-meeting":-1,_getblockmeeting:function(){return n.e(17).then(n.bind(null,"m0o0"))},"dialog-fastener":-1,_getdialogfastener:function(){return n.e(19).then(n.bind(null,"MsPD"))},"geometry-spread":-1,_getgeometryspread:function(){return n.e(6).then(n.bind(null,"ffeP"))},"circle-area":-1,_getcirclearea:function(){return n.e(24).then(n.bind(null,"YJB/"))},"number-list":-1,_getnumberlist:function(){return n.e(26).then(n.bind(null,"E6bU"))},getImport:function(e){return this["_get"+e.replace(/-/g,"")]()}};t.a=a},tvR6:function(e,t){}},["NHnr"]);